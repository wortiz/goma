<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Solver Specifications &mdash; Goma User Manual 6.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Eigensolver Specifications" href="eigensolver.html" />
    <link rel="prev" title="Augmenting Conditions Specifications" href="augmenting_conditions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Goma User Manual
            <img src="../_static/goma.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                6.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background.html">Background Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_structure_and_io.html">Code Structure and I/O</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../problem_description_file.html">Problem Description (Input File)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="file_specifications.html">File Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="general_specifications.html">General Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="time_integration.html">Time Integration Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="level_set.html">Level Set Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="phase_field.html">Phase Field Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="continuation.html">Continuation Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="hunting.html">Hunting Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="augmenting_conditions.html">Augmenting Conditions Specifications</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Solver Specifications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solution-algorithm">Solution Algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#description-usage">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#technical-discussion">Technical Discussion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#references"><strong>References</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-storage-format">Matrix Storage Format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Technical Discussion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#stratimikos-file">Stratimikos File</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Technical Discussion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#preconditioner">Preconditioner</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">Technical Discussion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-subdomain-solver">Matrix Subdomain Solver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id13">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15">Technical Discussion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-scaling">Matrix Scaling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id17">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-residual-norm-type">Matrix Residual Norm Type</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id20">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21"><strong>Examples</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22"><strong>Technical Discussion</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-output-type">Matrix Output Type</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id23">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24">Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-factorization-reuse">Matrix Factorization Reuse</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id25">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27"><strong>Technical Discussion</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-graph-fillin">Matrix Graph Fillin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id28">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id29">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id30">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-factorization-overlap">Matrix Factorization Overlap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id31">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id32">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id33">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-overlap-type">Matrix Overlap Type</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id34">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id35">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id36">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-auxiliary-vector">Matrix Auxiliary Vector</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id37">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id38">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id39">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-drop-tolerance">Matrix Drop Tolerance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id40">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id41">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id42">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-polynomial-order">Matrix Polynomial Order</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id43">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id44">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id45">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-reorder">Matrix Reorder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id46">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id47">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id48">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-factorization-save">Matrix Factorization Save</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id49">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id50">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id51">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-ilut-fill-factor">Matrix ILUT Fill Factor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id52">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id53">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id54">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-rilu-relax-factor">Matrix RILU Relax Factor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id55">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id56">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id57">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-bilu-threshold">Matrix BILU Threshold</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id58">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id59">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id60">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-relative-threshold">Matrix Relative Threshold</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id61">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id62">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id63">Technical Discussion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id64">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-absolute-threshold">Matrix Absolute Threshold</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id65">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id66">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id67"><strong>Technical Discussion</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id68">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#size-of-krylov-subspace">Size of Krylov Subspace</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id69">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id70">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id71">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#orthogonalization">Orthogonalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id72">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id73">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id74">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#maximum-linear-solve-iterations">Maximum Linear Solve Iterations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id75">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id76">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id77">Technical Discussion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id78">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#number-of-newton-iterations">Number of Newton Iterations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id79">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id80">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id81">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#modified-newton-tolerance">Modified Newton Tolerance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id82">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id83">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id84">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jacobian-reform-time-stride">Jacobian Reform Time Stride</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id85">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id86">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id87">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#newton-correction-factor">Newton Correction Factor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id88">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id89">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id90">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#normalized-residual-tolerance">Normalized Residual Tolerance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id91">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id92">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id93">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#normalized-correction-tolerance">Normalized Correction Tolerance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id94">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id95">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id96">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#residual-ratio-tolerance">Residual Ratio Tolerance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id97">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id98">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id99">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pressure-stabilization">Pressure Stabilization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id100">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id101">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id102">Technical Discussion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id103">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pressure-stabilization-scaling">Pressure Stabilization Scaling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id104">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id105">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id106">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#linear-stability">Linear Stability</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id107">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id108">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id109">Technical Discussion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id110">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#filter-concentration">Filter Concentration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id111">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id112">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id113">Technical Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#disable-viscosity-sensitivities">Disable Viscosity Sensitivities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id114">Description / Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id115">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id116">Technical Discussion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="eigensolver.html">Eigensolver Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="boundary_conditions.html">Boundary Condition Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="rotation.html">Rotation Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="problem_description.html">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="post_processing.html">Post Processing Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="post_processing_fluxes.html">Post Processing Fluxes and Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="post_processing_particle.html">Post Processing Particle Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="post_processing_volume.html">Volumetric Integration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../material_files.html">Material Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation_lists.html">Appendix 1: Goma Documentation Lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../library_mode.html">Appendix 2: Using Goma in Library Mode</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Goma User Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../problem_description_file.html">Problem Description (Input File)</a> &raquo;</li>
      <li>Solver Specifications</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/problem_description_file/solver_specifications.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="solver-specifications">
<h1>Solver Specifications<a class="headerlink" href="#solver-specifications" title="Permalink to this headline"></a></h1>
<p>This required section directs the nonlinear iteration strategy with associated parameters (e.g.,
Newton’s method options), matrix solution strategy and parameters, and other sundry options and
toggles for the pressure stabilization approach and linear stability analysis capability. With regard
to the parameters associated with matrix solution methods, it is important to understand that there
are two major classes of solvers - direct and iterative solvers. Direct solvers are the most robust,
but can be computationally impractical for some larger systems. Iterative solvers and associated
preconditioners are the only practical options for large-scale problems (viz., very large twodimensional
problems and virtually all three-dimensional problems). Choosing the solver settings
for good convergence of iterative matrix solvers can be an artful task for Navier-Stokes problems
and other poorly conditioned systems. It is recommended that the user consult the comprehensive
report by Schunk, et al. (2002) for an overview and further usage tips.</p>
<section id="solution-algorithm">
<h2>Solution Algorithm<a class="headerlink" href="#solution-algorithm" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Solution</span> <span class="n">Algorithm</span> <span class="o">=</span> <span class="p">{</span><span class="n">char_string</span><span class="p">}</span>
</pre></div>
</div>
<section id="description-usage">
<h3>Description / Usage<a class="headerlink" href="#description-usage" title="Permalink to this headline"></a></h3>
<p>This required card selects an algorithm for the solution of the linear matrix system that
arises at each Newton iteration (either for a steady-state solution or for the solution at
each discrete time). Please note that at the time of this writing, new solver capabilities
were being generated; although the following information was complete and accurate,
it will likely be out of date by the time of publishing. Users should consult the CD
version of this document in the Goma Documentation System for up to date options.</p>
<p>There are three major matrix solver packages accessible in <em>Goma</em>, two direct
factorization collections and an iterative solver package. The first collection of direct
factorization methods in <em>Goma</em> include the Sparse1.3 package (Kundert and
Sangiovanni-Vincentelli, 1988) and Y12M direct factorization technique (Zlatev,
Wasniewski and Schaumburg, 1981) accessible via the Aztec linear solver package.
The second collection of direct factorization methods include two frontal solvers,
SNL_MPFRONT, an adaptation of R. Benner’s implementation of Hood’s (1976)
frontal method, and UMFPACK (Davis and Duff, 1997). SNL_MPFRONT is a
traditional frontal method while UMFPACK is a multi-frontal solver.</p>
<p>The Aztec 2.x linear solver package (Tuminaro, et. al., 1999) is the iterative solver
component of <em>Goma</em>. A successor to the krysolve 1.0 package (Schunk and Shadid,
1992) and the Aztec 1.0 package (Hutchinson, Shadid and Tuminaro, 1995), Aztec 2.x
includes support for distributed memory architectures and for matrices in either a
modified sparse row (MSR) format or a variable block row (VBR) format, as well as
their distributed memory extensions. Generally, convergence of these iterative methods can be accelerated by judicious use of a preconditioner (which many of the other <em>Solver
Specifications</em> cards address).</p>
<p>The options for this input card are listed below, but additional usage comments are
included as part of the Technical Discussion section of this card. These comments
provide assistance in choosing the <em>Solution Algorithm</em> for your problem.</p>
<p>Valid options for {char_string} are as follows:</p>
<dl>
<dt>lu</dt><dd><p>Direct factorization via Gaussian elimination using Sparse 1.3. This solver
is robust even for poorly conditioned matrix systems. It is unavailable
when running <em>Goma</em> on multiple processors.</p>
</dd>
<dt>front</dt><dd><p>Direct factorization based on Benner’s SNL_MPFRONT that eliminates
equations and variables as the fully assembled rows of the matrix are
acquired. This is the latest solver installed within <em>Goma</em> and users are
encouraged to report their successes and failures with this option as part
of testing. It is unavailable when running <em>Goma</em> on multiple processors.</p>
</dd>
<dt>umf/umff</dt><dd><p>Direct factorization using UMFPACK. This multi-frontal solver has been
hardwired to perform elimination only upon complete assembly. The <strong>umff</strong>
option forces a full factorization every time, whereas <strong>umf</strong> does not. It
is unavailable when running <em>Goma</em> on multiple processors.</p>
</dd>
<dt>y12m</dt><dd><p>Direct factorization using the Y12M package. This package is accessible
through the Aztec matrix solver interface and cannot be used for multiple
processor computations. Other direct solvers are recommended against this
one.</p>
</dd>
<dt>gmres</dt><dd><p>Iterative solver from the Aztec package using the restarted generalized
minimum residual method. Iterative solver options are important to
convergence of this method, e.g. <em>Preconditioner, Size of Krylov subspace,
Matrix,</em> etc.</p>
</dd>
<dt>cg</dt><dd><p>Iterative solver from the Aztec package using the conjugate gradient
method. Like other iterative solvers, the successful convergence of the
conjugate gradient method for a linear system depends on preconditioners
and other cards in the <em>Solver Specifications</em> section.</p>
</dd>
<dt>cgs</dt><dd><p>Iterative solver from the Aztec package using the conjugate gradient
squared method. Convergence of this method is frequently contingent on the
linear system and on the choice of other cards in the <em>Solver
Specifications</em> section.</p>
</dd>
<dt>tfqmr</dt><dd><p>Iterative solver from the Aztec package using the transposefree
quasi-minimum residual method. Convergence of this method is frequently
contingent on the linear system and on the choice of other cards in the
<em>Solver Specifications</em> section.</p>
</dd>
<dt>bicgstab</dt><dd><p>Iterative solver from the Aztec package using the biconjugate gradient with
stabilization. Convergence of this method is frequently contingent on the
linear system and on the choice of other cards in the Solver Specifications
section.</p>
</dd>
<dt>amesos</dt><dd><p>Allows access to direct solver options implemented in parallel. Please see
the user-notes below for Goma build options that must be exercised. This
package is part of the Trilinos 6.0 framework. With this option, you must
add an additional input card to specify the parallel direct solvers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Amesos</span> <span class="n">Solver</span> <span class="n">Package</span> <span class="o">=</span> <span class="p">{</span><span class="n">superlu</span> <span class="o">|</span> <span class="n">mumps</span> <span class="o">|</span> <span class="n">klu</span> <span class="o">|</span> <span class="n">umfpack</span><span class="p">}</span>
</pre></div>
</div>
<p>Of these four options, we currently recommend <strong>mumps</strong>.
All options can be run in parallel.</p>
</dd>
<dt>stratimikos</dt><dd><p>Interface to Trilino’s Stratimikos package
requires:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">storage</span> <span class="nb">format</span> <span class="o">=</span> <span class="n">epetra</span>
</pre></div>
</div>
<p>Allows block solvers, see also ref:<cite>Stratimikos File</cite></p>
</dd>
<dt>petsc</dt><dd><p>PETSc solver and preconditioner, will use <cite>petscrc</cite> file or <cite>-petsc</cite>
command line, see Technical Discussion for more information</p>
</dd>
</dl>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Solution</span> <span class="n">Algorithm</span> <span class="o">=</span> <span class="n">lu</span>
</pre></div>
</div>
<p>Another example (two cards) shows how to invoke a parallel direct solver:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Solution</span> <span class="n">Algorithm</span> <span class="o">=</span> <span class="n">amesos</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Amesos</span> <span class="n">Solver</span> <span class="n">Package</span> <span class="o">=</span> <span class="n">superlu</span>
</pre></div>
</div>
</section>
<section id="technical-discussion">
<h3>Technical Discussion<a class="headerlink" href="#technical-discussion" title="Permalink to this headline"></a></h3>
<p>The direct factorization options are the most robust but consume the most
computational resources (CPU time and memory, particularly for large and 3D
problems). The iterative methods consume less resources but may take some
experimentation to obtain convergence to the solution of the linear system. For
example, a poorly conditioned linear system may require a lot of preconditioning. The
conjugate gradient method may not be very useful on linear systems that are not symmetric
positive definite. Although the following guidelines are useful, selection of
the “right” linear solver requires experience, understanding and sometimes, luck.</p>
<ul>
<li><p><strong>lu</strong> - The Sparse1.3 direct solver, is the most robust solver in <em>Goma</em> in terms of
obtaining successful convergence for even poorly conditioned matrix systems. A significant
disadvantage, however, is that it can be computationally expensive for
large problems. Not only do the memory and CPU requirements grow with
problem size, but the initial symbolic factorization that seeks optimal reordering
also consumes greater CPU resources with larger problem sizes. For example, a
problem with 70,000 degrees of freedom that required 22 hours of CPU for the
initial factorization required only 1/2 hour for subsequent factorizations.
Furthermore, this solver is unavailable when <em>Goma</em> is run on multiple processors.
Its robustness makes it an excellent choice for small- and medium-sized problems.</p></li>
<li><p><strong>front</strong> - This solver is an adaptation for <em>Goma</em> of R. Benner’s frontal solver, which
itself includes considerable improvements compared to the pioneering frontal
solvers (Irons, 1970; Hood, 1976). The SNL_MPFRONT library is compiled and linked into <em>Goma</em>
only by choice. Direct factorization is done as the fully
assembled rows of the matrix are acquired. The frontal solver consumes CPU time
roughly comparable to Sparse 1.3, with the noted advantage of eliminating intraelement
fully summed equations as they are encountered and only keeping the
active working matrix in-core, thereby reducing memory requirements and
possible storage of matrix components to disk.</p></li>
<li><p><strong>umf/umff</strong> - UMFPACK 2.0d is a powerful direct solver that is generally faster
than Sparse 1.3a, though it might lack the robustness of the latter on infrequent
occasions. The implementation of UMFPACK within <em>Goma</em> is only barebones, i.e.
the multi-frontal solver has been hardwired to perform elimination only upon
complete assembly. Finally, usage of UMFPACK is governed by a license that limits usage to
educational, research and benchmarking purposes by nonprofit
organizations and the U.S. government. Please refer to the license statement
contained in the UMFPACK distribution for exact details. This solver was
implemented prior to <strong>front</strong> so it was the only direct solver alternative to lu for a
period of time. User’s should now evaluate performance of this solver against <strong>front</strong> on a case by case basis.</p></li>
<li><p><strong>gmres, cg, cgs, tfqmr, bicgstab</strong> - The convergence of each of these iterative
solvers is highly influenced by the kind of preconditioning selected. Often, the
method(s) will not converge at all without an appropriate level of preconditioning.
GMRES is considered one of the best iterative methods available, although there
are instances where each of the others is superior. It is a Krylov-based method and has an
additional input card, <em>Size of Krylov subspace</em>. As mentioned earlier, CG
should only be used on systems that are symmetric positive definite. See the <em>Matrix
subdomain</em>
solver card, and other <em>Solver Specifications</em> cards for guidance
on appropriate use of preconditioners; also consult Schunk, et. al. (2002).</p></li>
<li><p><strong>amesos</strong>: superlu, klu, umfpack - These solvers are all direct (not iterative, but
based on Gaussian elimination) and can be run in parallel with mpi. We
recommend these solvers when robustness is required over iterative solvers and
when the matrix assembly time is excessive, which is often the case when
overloaded equations like species diffusion, porous media equations, etc. are used.
This option also performs well for three-dimensional problems of small to
moderate size.</p></li>
<li><p><strong>stratimikos</strong>: mostly used for interfacing with Trilino’s <cite>Teko</cite> but can also call
full solver suite that is supported in Trilinos through xml files</p></li>
<li><p><strong>petsc</strong>: There are quite a lot of linear solvers and preconditioners available through
PETSc and most are configured through either command line arguments using <cite>-petsc</cite> or
using a <cite>petscrc</cite> file in your goma problem directory specifying petsc options</p>
<p>Options are specified using the usual <cite>ksp_type</cite> and <cite>pc_type</cite> etc</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ksp_type</span> <span class="n">gmres</span>
<span class="o">-</span><span class="n">pc_type</span> <span class="n">asm</span>
<span class="o">...</span> <span class="n">etc</span>
</pre></div>
</div>
<p>When in a segregated solve <cite>ksp</cite> and <cite>pc</cite> options should be prefixed with a 0-indexed <cite>-sys#</cite>
corresponding to each matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">sys0_ksp_type</span> <span class="n">gmres</span>
<span class="o">-</span><span class="n">sys0_pc_type</span> <span class="n">asm</span>
<span class="o">-</span><span class="n">sys1_ksp_type</span> <span class="n">gmres</span>
<span class="o">-</span><span class="n">sys1_pc_type</span> <span class="n">hypre</span>
<span class="o">...</span> <span class="n">etc</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="references">
<h3><strong>References</strong><a class="headerlink" href="#references" title="Permalink to this headline"></a></h3>
<p>SAND2001-3512J: Iterative Solvers and Preconditioners for Fully-coupled Finite
Element Formulations of Incompressible Fluid Mechanics and Related Transport
Problems, P. R. Schunk, M. A. Heroux, R. R. Rao, T. A. Baer, S. R. Subia and A. C.
Sun, March 2002.</p>
<p>G. H. Golub and C. F. V. Loan, Matrix Computations, Johns Hopkins University Press,
Baltimore, MD 3rd ed. (1996)</p>
<p>For all other references, please see <em>References</em> at the end of this manual.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-storage-format">
<h2>Matrix Storage Format<a class="headerlink" href="#matrix-storage-format" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">storage</span> <span class="nb">format</span> <span class="o">=</span> <span class="p">{</span><span class="n">msr</span> <span class="o">|</span> <span class="n">vbr</span><span class="p">}</span>
</pre></div>
</div>
<section id="id1">
<h3>Description / Usage<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h3>
<p>This optional card can be used to choose between two formats accepted by the Aztec
2.1 solver package. Valid options are:</p>
<dl class="simple">
<dt>msr</dt><dd><p>modified sparse row format (see Schunk and Shadid, 1992). This option is
the default option and is automatically used for all direct solver options.</p>
</dd>
<dt>vbr</dt><dd><p>variable block row format (see Heroux, 1992). This option should only be
selected when an Aztec iterative solver is chosen.</p>
</dd>
<dt>epetra</dt><dd><p>Compressed Sparse Row format using the Epetra library from Trilinos</p>
</dd>
</dl>
</section>
<section id="id2">
<h3>Examples<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">storage</span> <span class="nb">format</span> <span class="o">=</span> <span class="n">msr</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>Technical Discussion<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h3>
<p><em>Goma</em> supports two global matrix formats for its linear solvers. The advantage of
choosing <strong>vbr</strong> over the default <strong>msr</strong> format is a matter of which preconditioner option is
selected. (See Schunk, et al., 2002 on iterative methods.) When using the front solver
package, another format known as <strong>estifm</strong> is employed internally but not specified by
this card, which is not used in this case.</p>
</section>
<section id="id4">
<h3>References<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h3>
<p>SAND92-1158: Iterative Solvers in Implicit Finite Element Codes, Sandia Technical
Report, Schunk, P. R. and Shadid, J. N. (1992)</p>
<p>SAND2001-3512J: Iterative Solvers and Preconditioners for Fully-coupled Finite
Element Formulations of Incompressible Fluid Mechanics and Related Transport
Problems, P. R. Schunk, M. A. Heroux, R. R. Rao, T. A. Baer, S. R. Subia and A. C.
Sun, March 2002.</p>
<p>TR/PA/92/90: M. A. Heroux, A proposal for a sparse BLAS toolkit, Technical Report,
CERFACS, December 1992.</p>
</section>
</section>
<hr class="docutils" />
<section id="stratimikos-file">
<h2>Stratimikos File<a class="headerlink" href="#stratimikos-file" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Stratimikos</span> <span class="n">File</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">stratimikos</span><span class="o">.</span><span class="n">xml</span> <span class="n">default</span><span class="p">)</span>
</pre></div>
</div>
<section id="id5">
<h3>Description / Usage<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h3>
<dl class="simple">
<dt>&lt;filename&gt;</dt><dd><p>XML file where Stratimikos options are stored</p>
</dd>
</dl>
</section>
<section id="id6">
<h3>Examples<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Stratimikos</span> <span class="n">File</span> <span class="o">=</span> <span class="n">teko_ml_simplec</span><span class="o">.</span><span class="n">xml</span>
</pre></div>
</div>
</section>
<section id="id7">
<h3>Technical Discussion<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h3>
</section>
<section id="id8">
<h3>References<a class="headerlink" href="#id8" title="Permalink to this headline"></a></h3>
</section>
</section>
<hr class="docutils" />
<section id="preconditioner">
<h2>Preconditioner<a class="headerlink" href="#preconditioner" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Preconditioner</span> <span class="o">=</span> <span class="p">{</span><span class="n">char_string</span><span class="p">}</span>
</pre></div>
</div>
<section id="id9">
<h3>Description / Usage<a class="headerlink" href="#id9" title="Permalink to this headline"></a></h3>
<p>Iterative techniques for solving a linear matrix system (see above) often benefit from
preconditioning to aid convergence. This optional card provides for the selection of a
preconditioner from those available through Aztec. For direct factorization <em>Solution
Algorithm</em> specifications, the <em>Preconditioner</em> specification is immaterial since none is
performed; in such cases, this card should be omitted.</p>
<p>Valid options for {char_string} are listed below.</p>
<dl class="simple">
<dt>none</dt><dd><p>No preconditioning is performed. This is the default specification if no
preconditioner has been specified.</p>
</dd>
<dt>Jacobi</dt><dd><p>A k-step Jacobi preconditioner is used (block Jacobi for VBR matrices). The
number of Jacobi steps, k, is set using the <em>Matrix polynomial order</em> card.</p>
</dd>
<dt>Neumann</dt><dd><p>A Neumann series polynomial preconditioner is used, where the order of the
polynomial, k, is set using the <em>Matrix polynomial order</em> card.</p>
</dd>
<dt>ls</dt><dd><p>A least-squares polynomial preconditioner is used, where the order of the
polynomial, k, is set using the <em>Matrix polynomial order</em> card.</p>
</dd>
<dt>sym_GS</dt><dd><p>A k-step symmetric Gauss-Seidel preconditioner is used for non-overlapping
domain decomposition (additive Schwarz). In parallel, each processor
performs one step of symmetric Gauss-Seidel on its local matrix, followed
by communication to update boundary values from adjacent processors before
performing the next local symmetric Gauss-Seidel step. The number of steps,
k, is set using the <em>Matrix polynomial order</em> card.</p>
</dd>
<dt>lu</dt><dd><p>Approximately solve the processor’s local matrix via direct factorization
using Sparse 1.3 in conjunction with a userspecified <em>Matrix drop
tolerance.</em></p>
</dd>
<dt>dom_decomp</dt><dd><p>A domain-decomposition-based preconditioner (additive Schwarz). Each
processor augments its local matrix according to the <em>Matrix factorization
overlap</em> card and then approximately solves the resulting linear system
using the solver specified by the <em>Matrix subdomain solver</em> card. This is
the most often used <em>Preconditioner</em> card.</p>
</dd>
</dl>
</section>
<section id="id10">
<h3>Examples<a class="headerlink" href="#id10" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Preconditioner</span> <span class="o">=</span> <span class="n">dom_decomp</span>
</pre></div>
</div>
</section>
<section id="id11">
<h3>Technical Discussion<a class="headerlink" href="#id11" title="Permalink to this headline"></a></h3>
<p>Note that prior to Aztec 2.x, certain subdomain solvers were specified simply as
arguments to the <em>Preconditioner</em> card. While this historical usage is permitted via
limited backward compatibility in order to ease the transition from Aztec 1 usage, the
preferred usage is to specify ILU (and similar) preconditioners as a subdomain solver
using the more powerful and flexible options that are available using Aztec 2.x together
with this option for the preconditioner. Since subdomain solvers such as ILU and ILUT
are powerful and frequently used, this preconditioner option will predominate when
iterative solvers are being used, even in serial execution.</p>
<p>The most popular setting is <strong>dom_decomp</strong>, with a subdomain solver specified in the
<em>Matrix Subdomain Solver</em> card. For further details, consult Mike Heroux’s recipe for
applying preconditioners and what to dial the knobs to (in Schunk, et. al., 2002).</p>
</section>
<section id="id12">
<h3>References<a class="headerlink" href="#id12" title="Permalink to this headline"></a></h3>
<p>SAND2001-3512J: Iterative Solvers and Preconditioners for Fully-coupled Finite
Element Formulations of Incompressible Fluid Mechanics and Related Transport
Problems, P. R. Schunk, M. A. Heroux, R. R. Rao, T. A. Baer, S. R. Subia and A. C.
Sun, March 2002.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-subdomain-solver">
<h2>Matrix Subdomain Solver<a class="headerlink" href="#matrix-subdomain-solver" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">subdomain</span> <span class="n">solver</span> <span class="o">=</span> <span class="p">{</span><span class="n">char_string</span><span class="p">}</span>
</pre></div>
</div>
<section id="id13">
<h3>Description / Usage<a class="headerlink" href="#id13" title="Permalink to this headline"></a></h3>
<p>This optional card selects a solver to use in constructing a preconditioner. It is used in
conjunction with a <em>Preconditioner</em> setting.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Preconditioner</span> <span class="o">=</span> <span class="n">dom_decomp</span>
</pre></div>
</div>
<p>All of these preconditioners are available through the Aztec library. Valid options for
{char_string} are listed below.</p>
<dl>
<dt>lu</dt><dd><p>Approximately solve the processor’s local matrix via direct factorization
using Sparse 1.3 in conjunction with a userspecified <em>Matrix drop
tolerance.</em></p>
</dd>
<dt>ilut</dt><dd><p>Approximately solve the processor’s local matrix via ILUT (Saad, 1994.) The
factorization is affected by user-specified options for <em>Matrix drop
tolerance</em> as well as <em>Matrix ILUT fill factor.</em></p>
<p>This subdomain solver is among the more robust to recommend as a first
attempt; thus it has been chosen as the default if no subdomain solver is
specified.</p>
</dd>
<dt>ilu</dt><dd><p>Approximately factor the processor’s local matrix using ILU(k), where k is
specified by the user in the argument to <em>Matrix graph fillin.</em></p>
</dd>
<dt>rilu</dt><dd><p>Approximately factor the processor’s local matrix using RILU(k,ω), where
k is specified by the user in the argument to <em>Matrix graph fillin</em> and
ω is specified by the user in the argument to <em>Matrix RILU relax factor.</em>
(This option applies only to Trilinos.)</p>
</dd>
<dt>bilu</dt><dd><p>Approximately factor the processor’s local matrix using block ILU(k) for
a VBR format matrix, where k is specified by the user in the argument to
<em>Matrix graph fillin.</em> While not the most efficient preconditioner,
<strong>bilu</strong> is very robust. (This option applies only to Trilinos.)</p>
</dd>
<dt>icc</dt><dd><p>Incomplete Cholesky factorization. See the Aztec manual for a reference.</p>
</dd>
</dl>
<p>If this <em>Matrix subdomain solver</em> card is omitted, then the default selection is <strong>ilut.</strong></p>
</section>
<section id="id14">
<h3>Examples<a class="headerlink" href="#id14" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">subdomain</span> <span class="n">solver</span> <span class="o">=</span> <span class="n">ilut</span>
</pre></div>
</div>
</section>
<section id="id15">
<h3>Technical Discussion<a class="headerlink" href="#id15" title="Permalink to this headline"></a></h3>
<p>There is no real recipe to follow when choosing a preconditioner. In general, the
cheapest preconditioner that works should be used. If ILUT(1) does the job, great.
Sometimes the only preconditioner(s) that will work are very expensive. When the
preconditioner seems to take too much time, remember that you may not be choosing
the “wrong” preconditioner; the problem may just be that difficult.</p>
<p>Although Aztec 2.1 is being maintained and supported as a solver package for Goma,
the interative solvers and preconditioners are now primarily accessed through the
Trilinos library (as AztecOO), which is actively being developed and maintained at
Sandia National Laboratories. Note that some features can only be accessed through
Trilinos, as indicated above.</p>
</section>
<section id="id16">
<h3>References<a class="headerlink" href="#id16" title="Permalink to this headline"></a></h3>
<p>SAND2001-3512J: Iterative Solvers and Preconditioners for Fully-coupled Finite
Element Formulations of Incompressible Fluid Mechanics and Related Transport
Problems, P. R. Schunk, M. A. Heroux, R. R. Rao, T. A. Baer, S. R. Subia and A. C.
Sun, March 2002.</p>
<p>Saad, Y., 1994. “ILUT: a dual threshold incomplete ILU factorization”, Numerical
Linear Algebra with Applications, 1:387-402.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-scaling">
<h2>Matrix Scaling<a class="headerlink" href="#matrix-scaling" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">scaling</span> <span class="o">=</span> <span class="p">{</span><span class="n">char_string</span><span class="p">}</span>
</pre></div>
</div>
<section id="id17">
<h3>Description / Usage<a class="headerlink" href="#id17" title="Permalink to this headline"></a></h3>
<p>This optional card selects a scaling for the linear matrix system solution step.Valid
options for {char_string} are listed below.</p>
<dl class="simple">
<dt>none</dt><dd><p>No scaling is performed. This is the default if no <em>Matrix Scaling</em> card is
present.</p>
</dd>
<dt>Jacobi</dt><dd><p>Point Jacobi scaling is performed.</p>
</dd>
<dt>BJacobi</dt><dd><p>Block Jacobi scaling is performed if the underlying matrix format is VBR.
If the MSR matrix format is used, the scaling reverts to point Jacobi.</p>
</dd>
<dt>row_sum</dt><dd><p>Scale each row so the sum of the magnitudes of the nonzero elements is 1.</p>
</dd>
<dt>sym_diag</dt><dd><p>Symmetric scaling so that diagonal elements are 1.</p>
</dd>
<dt>sym_row_sum</dt><dd><p>Symmetric scaling using the matrix row sums.</p>
</dd>
</dl>
<p>If the <em>Matrix Scaling</em> card is omitted, the default selection is <strong>none.</strong></p>
</section>
<section id="id18">
<h3>Examples<a class="headerlink" href="#id18" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">scaling</span> <span class="o">=</span> <span class="n">sym_diag</span>
</pre></div>
</div>
</section>
<section id="id19">
<h3>Technical Discussion<a class="headerlink" href="#id19" title="Permalink to this headline"></a></h3>
<p>All of these scalings are supplied via the Aztec library and thus will not affect the linear
systems that are solved by other means (using <strong>front</strong>, for example). In an odd twist of
fate, the linear system always undergoes a row sum scaling (equivalent to the <strong>row_sum</strong>
option) before these other scalings are applied. Note that when a nontrivial scaling is
selected, the matrix is overwritten with a rescaled system.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-residual-norm-type">
<h2>Matrix Residual Norm Type<a class="headerlink" href="#matrix-residual-norm-type" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">residual</span> <span class="n">norm</span> <span class="nb">type</span> <span class="o">=</span> <span class="p">{</span><span class="n">char_string</span><span class="p">}</span>
</pre></div>
</div>
<section id="id20">
<h3>Description / Usage<a class="headerlink" href="#id20" title="Permalink to this headline"></a></h3>
<p>This optional card selects the type of norm that is used to measure the size of the
residuals occurring during the solution of the linear matrix system <span class="math notranslate nohighlight">\(r \left( z \right) = b - Az\)</span>, where
<span class="math notranslate nohighlight">\(z\)</span> is an approximation to the solution <span class="math notranslate nohighlight">\(x\)</span> of the linear matrix problem <span class="math notranslate nohighlight">\(Ax = b\)</span>. The types
of norms used by the linear solver are controlled by values of {char_string}:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>{char_string}</p></th>
<th class="head"><p>Norm type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>r0</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\lVert r \rVert_2}{\lVert r^0 \rVert_2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><strong>rhs</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\lVert r \rVert_2}{\lVert b \rVert_2}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><strong>Anorm</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\lVert r \rVert_2}{\lVert A \rVert_{\infty}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><strong>sol</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\lVert r \rVert_{\infty}}{\lVert A \rVert_{\infty} \lVert x \rVert_1 + \lVert b \rVert_{\infty} }\)</span></p></td>
</tr>
<tr class="row-even"><td><p><strong>noscaled</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\lVert r \rVert_2\)</span></p></td>
</tr>
</tbody>
</table>
<p>The (0) superscript for the <strong>r0</strong> specification indicates the initial value of the residual.</p>
<p>If the <em>Matrix residual norm type</em> card is omitted, the default is <strong>r0.</strong></p>
</section>
<section id="id21">
<h3><strong>Examples</strong><a class="headerlink" href="#id21" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">residual</span> <span class="n">norm</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">r0</span>
</pre></div>
</div>
</section>
<section id="id22">
<h3><strong>Technical Discussion</strong><a class="headerlink" href="#id22" title="Permalink to this headline"></a></h3>
<p>For direct factorization linear solution algorithms, the norm should become very small
in the single iteration that is performed. This card is more pertinent when an iterative
solution algorithm has been specified.</p>
<p>Note the distinction between the residual for the overall global Newton iteration and
use of the term residual to describe an aspect of the linear solver iteration. For the linear
matrix systems, a residual <span class="math notranslate nohighlight">\(r\)</span> may be computed for any guess of the solution to <span class="math notranslate nohighlight">\(Ax = b\)</span> as
<span class="math notranslate nohighlight">\(r(z) = b - Az\)</span>. If <span class="math notranslate nohighlight">\(z = x\)</span>, the actual solution, then the residual is zero; otherwise, it is
some vector with a nonzero norm.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-output-type">
<h2>Matrix Output Type<a class="headerlink" href="#matrix-output-type" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">output</span> <span class="nb">type</span> <span class="o">=</span> <span class="p">{</span><span class="n">char_string</span><span class="p">}</span>
</pre></div>
</div>
<section id="id23">
<h3>Description / Usage<a class="headerlink" href="#id23" title="Permalink to this headline"></a></h3>
<p>This optional card indicates a level of diagnostic output for Aztec. The valid input
parameters for {char_string} are either a string or a positive integer:</p>
<dl class="simple">
<dt>all</dt><dd><p>Print matrix and indexing vectors for each processor and all intermediate
residual expressions.</p>
</dd>
<dt>none</dt><dd><p>No intermediate results are printed. This is the default.</p>
</dd>
<dt>warnings</dt><dd><p>Only Aztec warnings are printed.</p>
</dd>
<dt>last</dt><dd><p>Only the final residual expression is printed.</p>
</dd>
<dt>k</dt><dd><p>Residual expressions are printed every <em>k</em> iterations, k &gt; 0.</p>
</dd>
</dl>
<p>If the <em>Matrix output type</em> card is omitted, the default is <strong>none.</strong></p>
</section>
<section id="id24">
<h3>Examples<a class="headerlink" href="#id24" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">output</span> <span class="nb">type</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="matrix-factorization-reuse">
<h2>Matrix Factorization Reuse<a class="headerlink" href="#matrix-factorization-reuse" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">factorization</span> <span class="n">reuse</span> <span class="o">=</span> <span class="p">{</span><span class="n">char_string</span><span class="p">}</span>
</pre></div>
</div>
<section id="id25">
<h3>Description / Usage<a class="headerlink" href="#id25" title="Permalink to this headline"></a></h3>
<p>This optional card directs the approximate factorization solvers used in preconditioner
construction to reuse matrix information that may have been obtained during previous
linear solution stages. This card only has an effect when using an Aztec solver. Valid
options for {char_string} are:</p>
<dl class="simple">
<dt>calc</dt><dd><p>Use no information from previous linear solutions.</p>
</dd>
<dt>recalc</dt><dd><p>Use information from previous linear solutions but recalculate the
preconditioning factors, with the implication that the symbolic
factorization will be similar.</p>
</dd>
<dt>reuse</dt><dd><p>Use information from previous linear solution; do not recalculate
preconditioner factorizations. However, use scaling factors from previous
linear solutions to scale righthand sides, initial guesses, and final
solutions.</p>
</dd>
</dl>
<p>If the <em>Matrix factorization</em> reuse card is omitted, the default is <strong>recalc.</strong></p>
</section>
<section id="id26">
<h3>Examples<a class="headerlink" href="#id26" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">factorization</span> <span class="n">reuse</span> <span class="o">=</span> <span class="n">recalc</span>
</pre></div>
</div>
</section>
<section id="id27">
<h3><strong>Technical Discussion</strong><a class="headerlink" href="#id27" title="Permalink to this headline"></a></h3>
<p>See related discussions for <em>Matrix factorization save</em>.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-graph-fillin">
<h2>Matrix Graph Fillin<a class="headerlink" href="#matrix-graph-fillin" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">graph</span> <span class="n">fillin</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span><span class="mf">4.7.10</span><span class="n">_matrix_factorization_overlap</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<section id="id28">
<h3>Description / Usage<a class="headerlink" href="#id28" title="Permalink to this headline"></a></h3>
<p>This optional card sets the graph level of fill-in for approximate factorizations used in
preconditioner construction for ILU(k), ICC(k) and BILU(k). The input parameter is
defined as</p>
<dl class="simple">
<dt>&lt;integer&gt;</dt><dd><p>k, specifies the graph level of fill-in, k &gt; 0.</p>
</dd>
</dl>
<p>If the <em>Matrix graph fillin</em> card is omitted, the default value of <strong>k</strong> is <strong>0.</strong></p>
</section>
<section id="id29">
<h3>Examples<a class="headerlink" href="#id29" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">graph</span> <span class="n">fillin</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</section>
<section id="id30">
<h3>Technical Discussion<a class="headerlink" href="#id30" title="Permalink to this headline"></a></h3>
<p>As the level of graph fill-in increases, the accuracy (usefulness) of the preconditioner
increases; however, so does memory usage as well as the time required to compute the
preconditioner.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-factorization-overlap">
<h2>Matrix Factorization Overlap<a class="headerlink" href="#matrix-factorization-overlap" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">factorization</span> <span class="n">overlap</span> <span class="o">=</span> <span class="p">{</span><span class="n">char_string</span><span class="p">}</span>
</pre></div>
</div>
<section id="id31">
<h3>Description / Usage<a class="headerlink" href="#id31" title="Permalink to this headline"></a></h3>
<p>This optional card determines how much matrix factorization overlap occurs with other
processors. This specification is only relevant for parallel computations. The valid
options for {char_string} are:</p>
<dl class="simple">
<dt>none</dt><dd><p>No augmentation is performed, equivalent to a setting of k=0. This is the
default.</p>
</dd>
<dt>diag</dt><dd><p>Augment the processor’s local matrix to include the diagonal (MSR) or
diagonal blocks (VBR) for external rows.</p>
</dd>
<dt>k</dt><dd><p>Augment the processor’s local matrix to include external rows. The rows are
selected by examining non-zero columns from the current local system that
refer to offprocessor unknowns, and including the rows associated with
those off-processor unknowns. This process is repeated <em>k</em> times, where
k &gt; 0. When complete, all non-zero columns whose associated rows have not
been included are discarded. A value of 0 is equivalent to a setting of
none.</p>
</dd>
</dl>
<p>If the <em>Matrix factorization overlap</em> card is omitted, the default is <strong>none.</strong></p>
</section>
<section id="id32">
<h3>Examples<a class="headerlink" href="#id32" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">factorization</span> <span class="n">overlap</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="id33">
<h3>Technical Discussion<a class="headerlink" href="#id33" title="Permalink to this headline"></a></h3>
<p>This optional card determines how much a processor’s local matrix is to be augmented
with information from adjacent processors during the approximate factorizations used
to build preconditioners. This card should be omitted or given a value of <strong>none</strong> for serial
executions.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-overlap-type">
<h2>Matrix Overlap Type<a class="headerlink" href="#matrix-overlap-type" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">overlap</span> <span class="nb">type</span> <span class="o">=</span> <span class="p">{</span><span class="n">standard</span> <span class="o">|</span> <span class="n">symmetric</span><span class="p">}</span>
</pre></div>
</div>
<section id="id34">
<h3>Description / Usage<a class="headerlink" href="#id34" title="Permalink to this headline"></a></h3>
<p>This card selects the kind of matrix overlap that occurs (for parallel computations).
Valid options are:</p>
<dl class="simple">
<dt>standard</dt><dd><p>The local processor considers only its own estimate for any unknown;
results from adjacent processors are ignored. This is the default.</p>
</dd>
<dt>symmetric</dt><dd><p>The local processor adds its own estimate together with estimates from
adjacent processors, retaining symmetry of preconditioners if a symmetric
technique is being employed.</p>
</dd>
</dl>
<p>If the <em>Matrix ovelap type</em> card is omitted, the default is <strong>standard.</strong></p>
</section>
<section id="id35">
<h3>Examples<a class="headerlink" href="#id35" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">overlap</span> <span class="nb">type</span><span class="o">=</span> <span class="n">symmetric</span>
</pre></div>
</div>
</section>
<section id="id36">
<h3>Technical Discussion<a class="headerlink" href="#id36" title="Permalink to this headline"></a></h3>
<p>This optional card determines how overlapping subdomain solver results are combined
when different processors derive different estimates for the same solution unknown.</p>
<p>This overlap option is moot for serial problems whose data decomposition is trivial.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-auxiliary-vector">
<h2>Matrix Auxiliary Vector<a class="headerlink" href="#matrix-auxiliary-vector" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">auxiliary</span> <span class="n">vector</span> <span class="o">=</span> <span class="p">{</span><span class="n">resid</span> <span class="o">|</span> <span class="n">rand</span><span class="p">}</span>
</pre></div>
</div>
<section id="id37">
<h3>Description / Usage<a class="headerlink" href="#id37" title="Permalink to this headline"></a></h3>
<p>This optional card indicates to Aztec how the auxiliary vector r is determined.
Permissible options are:</p>
<dl class="simple">
<dt>resid</dt><dd><p>The auxiliary vector is set to the initial residual vector, viz. <span class="math notranslate nohighlight">\(r = r(0)\)</span>.</p>
</dd>
<dt>rand</dt><dd><p>The auxiliary vector is filled with random numbers, each in the range
<span class="math notranslate nohighlight">\([-1,1]\)</span>.</p>
</dd>
</dl>
<p>If the <em>Matrix auxiliary vector</em> card is omitted, the default is <strong>resid.</strong></p>
</section>
<section id="id38">
<h3>Examples<a class="headerlink" href="#id38" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">auxiliary</span> <span class="n">vector</span> <span class="o">=</span> <span class="n">rand</span>
</pre></div>
</div>
</section>
<section id="id39">
<h3>Technical Discussion<a class="headerlink" href="#id39" title="Permalink to this headline"></a></h3>
<p>The auxiliary vector is only used for certain iterative linear matrix solution algorithms.</p>
<p>The <strong>rand</strong> option may cause difficulties with initial iterative solver steps because
different processors may have different initial unknown values at shared unknowns.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-drop-tolerance">
<h2>Matrix Drop Tolerance<a class="headerlink" href="#matrix-drop-tolerance" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">drop</span> <span class="n">tolerance</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id40">
<h3>Description / Usage<a class="headerlink" href="#id40" title="Permalink to this headline"></a></h3>
<p>This optional card indicates to Aztec a drop tolerance to be used in conjunction with
preconditioners based on LU or on ILUT. The &lt;float&gt; input parameter is:</p>
<dl class="simple">
<dt>&lt;float&gt;</dt><dd><p><strong>tol,</strong> a floating point number ( <span class="math notranslate nohighlight">\(tol \geq 0\)</span> ) that specifies the drop
tolerance.</p>
</dd>
</dl>
<p>If the <em>Matrix drop tolerance</em> card is omitted, the default is <strong>0.0.</strong></p>
</section>
<section id="id41">
<h3>Examples<a class="headerlink" href="#id41" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">drop</span> <span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>
</div>
</section>
<section id="id42">
<h3>Technical Discussion<a class="headerlink" href="#id42" title="Permalink to this headline"></a></h3>
<p>When constructing the partial factorization(s), any value less than tol is dropped. If set
to 0.0, then other parameters will govern preconditioner size and components (e.g.,
<em>Matrix ILUT fill factor</em> for the ILUT preconditioner).</p>
<p>The two main parameters when using the ILUT preconditioner are this card and the
<em>Matrix ILUT fill factor</em> card. The restrictions in <em>Matrix ILUT fill factor</em> take precedence
over the dropped entries caused by this card.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-polynomial-order">
<h2>Matrix Polynomial Order<a class="headerlink" href="#matrix-polynomial-order" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">polynomial</span> <span class="n">order</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id43">
<h3>Description / Usage<a class="headerlink" href="#id43" title="Permalink to this headline"></a></h3>
<p>This optional card allows selection of polynomial order when a polynomial
preconditioning option is selected (see the <em>Preconditioner</em> card). The input parameter is
defined as:</p>
<dl class="simple">
<dt>&lt;integer&gt;</dt><dd><p>Number of steps, <strong>k</strong> ( ≥ 0 ), to take when using matrix polynomial based
preconditioners (Jacobi and symmetric Gauss-Seidel, for example).</p>
</dd>
</dl>
<p>If the Matrix polynomial order card is omitted, then the default selection is <strong>k=3.</strong></p>
</section>
<section id="id44">
<h3>Examples<a class="headerlink" href="#id44" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">polynomial</span> <span class="n">order</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
</section>
<section id="id45">
<h3>Technical Discussion<a class="headerlink" href="#id45" title="Permalink to this headline"></a></h3>
<p>When used, the value of this parameter should be greater than 0, and probably no more
than 10. In some, if not all, cases, a value of 0 is meaningless.</p>
<p>This card is not used if the preconditioner does not use matrix polynomials.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-reorder">
<h2>Matrix Reorder<a class="headerlink" href="#matrix-reorder" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">reorder</span> <span class="o">=</span> <span class="p">{</span><span class="n">none</span> <span class="o">|</span> <span class="n">rcm</span><span class="p">}</span>
</pre></div>
</div>
<section id="id46">
<h3>Description / Usage<a class="headerlink" href="#id46" title="Permalink to this headline"></a></h3>
<p>This optional card determines whether RCM (Reverse Cuthill-McKee) reordering of
the linear system is to be performed. Valid options are:</p>
<dl class="simple">
<dt>none</dt><dd><p>the equations are not reordered.</p>
</dd>
<dt>rcm</dt><dd><p>the equations are reordered using an RCM scheme.</p>
</dd>
</dl>
<p>If the <em>Matrix reorder</em> card is omitted, then the default selection is <strong>none.</strong></p>
</section>
<section id="id47">
<h3>Examples<a class="headerlink" href="#id47" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">reorder</span> <span class="o">=</span> <span class="n">rcm</span>
</pre></div>
</div>
</section>
<section id="id48">
<h3>Technical Discussion<a class="headerlink" href="#id48" title="Permalink to this headline"></a></h3>
<p>Note that reordering frequently is helpful in achieving convergence for iterative
solution of linear systems. In a few instances, however, <em>Goma</em> users have noted that
RCM reordering hinders convergence for selected problems. The default for <em>Goma</em> is to
not use the RCM reordering so that quantitatively comparable results are obtained
using either Aztec 1 (which did not have RCM reordering as an option) or Aztec 2.x. In
summary, users are encouraged to try RCM reordering when using iterative solvers,
foregoing the option only as a further resort in the face of repeated convergence
failures.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-factorization-save">
<h2>Matrix Factorization Save<a class="headerlink" href="#matrix-factorization-save" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">factorization</span> <span class="n">save</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span> <span class="o">|</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
<section id="id49">
<h3>Description / Usage<a class="headerlink" href="#id49" title="Permalink to this headline"></a></h3>
<p>This optional card is a boolean specification that determines whether the preconditioner
factorization information should be kept after a solve. Valid options are</p>
<dl class="simple">
<dt>0</dt><dd><p>Factorization information is discarded.</p>
</dd>
<dt>1</dt><dd><p>Factorization information is kept for that step.</p>
</dd>
</dl>
<p>If the <em>Matrix factorization save</em> card is omitted, then the default selection is <strong>0.</strong></p>
</section>
<section id="id50">
<h3>Examples<a class="headerlink" href="#id50" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">factorization</span> <span class="n">save</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="id51">
<h3>Technical Discussion<a class="headerlink" href="#id51" title="Permalink to this headline"></a></h3>
<p>This option is most useful for iterative solution techniques where the computed
preconditioning matrix found from an incomplete factorization requires significant
computational resources. Such a preconditioner may be useful in later matrix solves
and obviate the need to compute another expensive preconditioner at the later stage.
Although a lot of time may be saved by re-using a previous factorization, the loss in
accuracy may cause convergence problems.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-ilut-fill-factor">
<h2>Matrix ILUT Fill Factor<a class="headerlink" href="#matrix-ilut-fill-factor" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">ILUT</span> <span class="n">fill</span> <span class="n">factor</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id52">
<h3>Description / Usage<a class="headerlink" href="#id52" title="Permalink to this headline"></a></h3>
<p>This optional card provides a second criterion to Aztec to be used in conjunction with
preconditioners based on ILUT approximate factorization, where</p>
<dl class="simple">
<dt>&lt;float&gt;</dt><dd><p><strong>fac,</strong> a floating point value ( fac ≥ 0 ) that specifies, very crudely,
how many nonzero entries the approximate factorization will contain
relative to the number of nonzero entries in the original matrix.</p>
</dd>
</dl>
<p>If the <em>Matrix ILUT fill factor</em> card is omitted, the default is <strong>1.</strong></p>
</section>
<section id="id53">
<h3>Examples<a class="headerlink" href="#id53" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">ILUT</span> <span class="n">fill</span> <span class="n">factor</span> <span class="o">=</span> <span class="mf">2.0</span>
</pre></div>
</div>
</section>
<section id="id54">
<h3>Technical Discussion<a class="headerlink" href="#id54" title="Permalink to this headline"></a></h3>
<p>By increasing this factor, the preconditioner becomes more accurate because more
terms in the preconditioner (pseudo-inverse) are retained. A value of 1.0 indicates that
the preconditioner would contain approximately the same number of nonzero entries as
the original matrix.</p>
<p>The two main parameters when using the ILUT preconditioner are this card and the
<em>Matrix drop tolerance</em> card. If the <em>Matrix drop tolerance</em> is 0.0, then this card
determines the size of the preconditioner. If <em>Matrix drop tolerance</em> is greater than 0.0,
then the approximate factorization is first created subject to this card’s restriction, and
then the drop tolerance is applied. This can result in a preconditioner with significantly
fewer nonzero entries.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-rilu-relax-factor">
<h2>Matrix RILU Relax Factor<a class="headerlink" href="#matrix-rilu-relax-factor" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">RILU</span> <span class="n">relax</span> <span class="n">factor</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id55">
<h3>Description / Usage<a class="headerlink" href="#id55" title="Permalink to this headline"></a></h3>
<p>This optional card provides a relaxation factor to Aztec to be used in conjunction with
preconditioners based on RILU(k,ω) approximate factorization. The input parameter
&lt;float&gt; is defined as</p>
<dl class="simple">
<dt>&lt;float&gt;</dt><dd><p><strong>fac,</strong> a floating point number ( fac ≥ 0 ) that specifies a relaxation
factor.</p>
</dd>
</dl>
<p>If the <em>Matrix RILU relax factor</em> card is omitted, the default is <strong>1.</strong></p>
</section>
<section id="id56">
<h3>Examples<a class="headerlink" href="#id56" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">RILU</span> <span class="n">relax</span> <span class="n">factor</span> <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
</section>
<section id="id57">
<h3>Technical Discussion<a class="headerlink" href="#id57" title="Permalink to this headline"></a></h3>
<p>Some limiting values for fac provide specific behavior:</p>
<ul class="simple">
<li><p>for a value of zero, the ILU(k) is obtained</p></li>
<li><p>for a value of one, the MILU(k) is obtained.</p></li>
</ul>
<p>The value of <em>k</em> is set by the <em>Matrix graph fillin</em> card.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-bilu-threshold">
<h2>Matrix BILU Threshold<a class="headerlink" href="#matrix-bilu-threshold" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">BILU</span> <span class="n">threshold</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id58">
<h3>Description / Usage<a class="headerlink" href="#id58" title="Permalink to this headline"></a></h3>
<p>This capability is only present within the Trilinos library. This optional card provides a
means to modify the way the block ILU preconditioner (<em>Matrix subdomain solver</em> =
<strong>bilu</strong>) is constructed. The input parameter is defined as:</p>
<dl class="simple">
<dt>&lt;float&gt;</dt><dd><p><strong>t,</strong> a floating point number ( t ≥ 0.0 ) that sets the <em>Matrix Relative
Threshold</em> and <em>Matrix Absolute Threshold</em> thresholds.</p>
</dd>
</dl>
<p>When the <em>Matrix BILU threshold</em> card is omitted, the default value is 0.0.</p>
</section>
<section id="id59">
<h3>Examples<a class="headerlink" href="#id59" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">BILU</span> <span class="n">Threshold</span> <span class="o">=</span> <span class="mf">1.0e-14</span>
</pre></div>
</div>
</section>
<section id="id60">
<h3>Technical Discussion<a class="headerlink" href="#id60" title="Permalink to this headline"></a></h3>
<p>Using this card is equivalent to supplying both the <em>Matrix Relative Threshold</em> and
<em>Matrix Absolute Threshold</em> with the value specified with this card.</p>
<p>The value of <strong>t</strong> defaults to zero, and if given a small value, say 1.0e-14, the condition
number of the preconditioner, as reported when using the <strong>bilu</strong> option, should decrease.
Try increasing up to around 1.0e-3 to get added benefit. The <strong>bilu</strong> preconditioner is not
actually the cheapest or most efficient preconditioner, but it is very robust.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-relative-threshold">
<h2>Matrix Relative Threshold<a class="headerlink" href="#matrix-relative-threshold" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">Relative</span> <span class="n">Threshold</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id61">
<h3>Description / Usage<a class="headerlink" href="#id61" title="Permalink to this headline"></a></h3>
<p>This card is only available with the Trilinos library. The effect of this card is to impose
a relative lower bound to either a diagonal value or a singular value. The legal values
for &lt;float&gt; are:</p>
<dl class="simple">
<dt>&lt;float&gt;</dt><dd><p><strong>r</strong>, a floating point number ( r ≥ 0.0 ) that specifies a relative
threshold.</p>
</dd>
</dl>
<p>If this card is omitted, the default is 0.0.</p>
</section>
<section id="id62">
<h3>Examples<a class="headerlink" href="#id62" title="Permalink to this headline"></a></h3>
<p>A sample input card follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">Relative</span> <span class="n">Threshold</span> <span class="o">=</span> <span class="mf">1.e-4</span>
</pre></div>
</div>
</section>
<section id="id63">
<h3>Technical Discussion<a class="headerlink" href="#id63" title="Permalink to this headline"></a></h3>
<p>This card, along with the <em>Matrix Absolute Threshold</em> card, allow the user to modify the
linear system prior to calculation of the preconditioner. Note that the modification is
only to change the “initial condition” of the preconditioner–it does not actually change
the linear system.</p>
<p>Let <strong>t</strong> be the value specified with the Matrix Absolute Threshold card. For a scalar-based
preconditioner (<strong>ilut, ilu, rilu, icc</strong>), each value on the diagonal undergoes the following
substitution:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[d_{\mathrm{new}} = r * d_{\mathrm{old}} + \mathrm{sgn} \left( d_{\mathrm{old}}  \right) * t\]</div>
</div></blockquote>
<p>For the <strong>bilu</strong> preconditioner, each singular value of the diagonal block preconditioner is
compared to:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\sigma_{\mathrm{min}} = r * \sigma_1 + t\]</div>
</div></blockquote>
<p>where σ1 is the largest singular value of the diagonal block under consideration. All <span class="math notranslate nohighlight">\(\sigma_k\)</span>
are modified (if necessary) to be at least as large as <span class="math notranslate nohighlight">\(\sigma_{\mathrm{min}}\)</span>.</p>
<p>The appropriate values for the threshold can vary over many orders of magnitude
depending on the situation. Refer to Schunk, et. al., 2002 for information and for
further guidance.</p>
</section>
<section id="id64">
<h3>References<a class="headerlink" href="#id64" title="Permalink to this headline"></a></h3>
<p>SAND2001-3512J: Iterative Solvers and Preconditioners for Fully-coupled Finite
Element Formulations of Incompressible Fluid Mechanics and Related Transport
Problems, P. R. Schunk, M. A. Heroux, R. R. Rao, T. A. Baer, S. R. Subia and A. C.
Sun, March 2002.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-absolute-threshold">
<h2>Matrix Absolute Threshold<a class="headerlink" href="#matrix-absolute-threshold" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">Absolute</span> <span class="n">Threshold</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id65">
<h3>Description / Usage<a class="headerlink" href="#id65" title="Permalink to this headline"></a></h3>
<p>This card is only available with the Trilinos library. It allows the user to specify a lower
bound for either a diagonal entry or a singular value. The exact meaning depends on the
kind of preconditioner used (scalar-based or block-based). The legal values are:</p>
<dl class="simple">
<dt>&lt;float&gt;</dt><dd><p><strong>t,</strong> a floating point number ( t ≥ 0.0 ) that specifies a minimum
threshold value for diagonal or singular value.</p>
</dd>
</dl>
<p>Along with the <em>Matrix Relative Threshold</em> card, this card gives the user the ability to
modify what matrix the preconditioner operates on. See the <em>Matrix Relative Threshold</em>
card for a full description.</p>
<p>If this card is omitted, the default is 0.0.</p>
</section>
<section id="id66">
<h3>Examples<a class="headerlink" href="#id66" title="Permalink to this headline"></a></h3>
<p>A sample input card follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span> <span class="n">Absolute</span> <span class="n">Threshold</span> <span class="o">=</span> <span class="mf">1.e-4</span>
</pre></div>
</div>
</section>
<section id="id67">
<h3><strong>Technical Discussion</strong><a class="headerlink" href="#id67" title="Permalink to this headline"></a></h3>
<p>Refer to the discussion for card <em>Matrix Relative Threshold</em>. The appropriate values for
the threshold can vary over many orders of magnitude depending on the situation.
Refer to Schunk, et. al., 2002 for information and for further guidance.</p>
</section>
<section id="id68">
<h3>References<a class="headerlink" href="#id68" title="Permalink to this headline"></a></h3>
<p>SAND2001-3512J: Iterative Solvers and Preconditioners for Fully-coupled Finite
Element Formulations of Incompressible Fluid Mechanics and Related Transport
Problems, P. R. Schunk, M. A. Heroux, R. R. Rao, T. A. Baer, S. R. Subia and A. C.
Sun, March 2002.</p>
</section>
</section>
<hr class="docutils" />
<section id="size-of-krylov-subspace">
<h2>Size of Krylov Subspace<a class="headerlink" href="#size-of-krylov-subspace" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Size</span> <span class="n">of</span> <span class="n">Krylov</span> <span class="n">subspace</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id69">
<h3>Description / Usage<a class="headerlink" href="#id69" title="Permalink to this headline"></a></h3>
<p>This optional card allows the user to specify the dimension (size) of the Krylov
subspace for the <strong>gmres</strong> option of the <em>Solution Algorithm</em> card, where</p>
<dl class="simple">
<dt>&lt;integer&gt;</dt><dd><p><strong>m,</strong> specifies the number of orthogonalization directions and can be any
positive integer less than or equal to the order of the matrix.</p>
</dd>
</dl>
<p>If the <em>Size of Krylov subspace</em> card is omitted, then the default dimension is <strong>m</strong> = 30.</p>
</section>
<section id="id70">
<h3>Examples<a class="headerlink" href="#id70" title="Permalink to this headline"></a></h3>
<p>The following is a sample input card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Size</span> <span class="n">of</span> <span class="n">Krylov</span> <span class="n">subspace</span> <span class="o">=</span> <span class="mi">128</span>
</pre></div>
</div>
</section>
<section id="id71">
<h3>Technical Discussion<a class="headerlink" href="#id71" title="Permalink to this headline"></a></h3>
<p>If the size of the subspace is at least as large as the maximum number of iterations
permitted by the solver then the <strong>gmres</strong> iteration will not include any restarts.
Depending on the problem, restarts may be beneficial, and then again they may not.
Particularly poorly conditioned linear systems may never converge below a certain
tolerance if <strong>gmres</strong> is allowed to restart (i.e. they “level off”). However, some linear
systems will admit a converged solution more rapidly with restarts than without.
Consequently, the user may wish to experiment with different values of this parameter.
See the Orthogonalization card for related information.</p>
<p><strong>gmres’</strong> internal iterations create a Krylov subspace up to dimension m (less in some
circumstances, such as convergence). The time and space required by the internal
iterations increases nonlinearly with <strong>m</strong> (but see the <em>Orthogonalization</em> card) - a
doubling of <strong>m</strong> will result in more than a doubling of space and time requirements. So
simply choosing a very large dimension is generally not recommended.</p>
</section>
</section>
<hr class="docutils" />
<section id="orthogonalization">
<h2>Orthogonalization<a class="headerlink" href="#orthogonalization" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Orthogonalization</span> <span class="o">=</span> <span class="p">{</span><span class="n">classic</span> <span class="o">|</span> <span class="n">modified</span><span class="p">}</span>
</pre></div>
</div>
<section id="id72">
<h3>Description / Usage<a class="headerlink" href="#id72" title="Permalink to this headline"></a></h3>
<p>This optional card selects the orthogonalization scheme used internally for the gmres
solution algorithm (see the <em>Solution Algorithm</em> card). Valid options are</p>
<dl class="simple">
<dt>classic | classical</dt><dd><p>Two steps of classical Gram-Schmidt orthogonalization.</p>
</dd>
<dt>modified</dt><dd><p>A modified Gram-Schmidt orthogonalization.</p>
</dd>
</dl>
<p>If the <em>Orthogonalization</em> card is omitted, then the default selection is <strong>classic.</strong> Goma’s
parser will accept <strong>classical</strong> as equivalent to <strong>classic.</strong></p>
</section>
<section id="id73">
<h3>Examples<a class="headerlink" href="#id73" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Orthogonalization</span> <span class="o">=</span> <span class="n">modified</span>
</pre></div>
</div>
</section>
<section id="id74">
<h3>Technical Discussion<a class="headerlink" href="#id74" title="Permalink to this headline"></a></h3>
<p>By specifying <strong>modified,</strong> the user is greatly speeding up the <strong>gmres</strong> algorithm at the
expense of possibly losing convergence. A good indication that you should not have
used the <strong>modified</strong> setting is a premature “leveling off” of the sequence of residuals
produced internally within <strong>gmres.</strong></p>
</section>
</section>
<hr class="docutils" />
<section id="maximum-linear-solve-iterations">
<h2>Maximum Linear Solve Iterations<a class="headerlink" href="#maximum-linear-solve-iterations" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Maximum</span> <span class="n">Linear</span> <span class="n">Solve</span> <span class="n">Iterations</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id75">
<h3>Description / Usage<a class="headerlink" href="#id75" title="Permalink to this headline"></a></h3>
<p>This optional card limits the maximum number of iterations used by iterative linear
solver algorithms. The input parameter is defined as</p>
<dl class="simple">
<dt>&lt;integer&gt;</dt><dd><p>&lt;integer&gt; <strong>n,</strong> any positive integer ( n &gt; 0 ) that specifies the maximum
number of iterations.</p>
</dd>
</dl>
<p>If the <em>Maximum Linear Solve Iterations</em> card is omitted, the default selection is 500.</p>
</section>
<section id="id76">
<h3>Examples<a class="headerlink" href="#id76" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Maximum</span> <span class="n">Linear</span> <span class="n">Solve</span> <span class="n">Iterations</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</section>
<section id="id77">
<h3>Technical Discussion<a class="headerlink" href="#id77" title="Permalink to this headline"></a></h3>
<p>If the linear system can be solved within a specified tolerance (see the <em>Residual Ratio
Tolerance</em> card) in less than <strong>n</strong> iterations, then a normal return from Aztec occurs and
the actual number of iterations required to obtain convergence will be printed on the
status line. If the specified convergence tolerance is not met within <strong>n</strong> iterations, then an
abnormal return status occurs and, in place of the number of iterations, the string “max”
will be printed on the status line under the LIS (linear iteration status) heading. Other
abnormal returns from Aztec are possible and are indicated on the LIS status line; see
the Aztec User’s Guide (Hutchinson, Shadid and Tuminaro, 1995) for further
interpretation of different abnormal return status indicators.</p>
</section>
<section id="id78">
<h3>References<a class="headerlink" href="#id78" title="Permalink to this headline"></a></h3>
<p>SAND95-1559: Aztec User’s Guide Version 1.0, Sandia Internal Report, Hutchinson,
S. A., Shadid, J. N. and Tuminaro, R. S., 1995.</p>
</section>
</section>
<hr class="docutils" />
<section id="number-of-newton-iterations">
<h2>Number of Newton Iterations<a class="headerlink" href="#number-of-newton-iterations" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">Newton</span> <span class="n">Iterations</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">integer1</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">integer2</span><span class="p">]</span>
</pre></div>
</div>
<section id="id79">
<h3>Description / Usage<a class="headerlink" href="#id79" title="Permalink to this headline"></a></h3>
<p>This required card sets the maximum number of iterations allowed for convergence of
the Newton nonlinear iteration loop. It also provides an optional parameter for setting
the reformation stride for the Jacobian matrix. Definitions of the input parameters are
as follows:</p>
<dl class="simple">
<dt>&lt;integer1&gt;</dt><dd><p>n<sub>1</sub>, any integer indicating the maximum number of iterations
allowed for convergence of the Newton nonlinear iteration loop.</p>
</dd>
<dt>[integer2]</dt><dd><p>n<sub>2</sub>, an optional parameter indicating the reformation stride for
the Jacobian matrix.</p>
</dd>
</dl>
<p>The <em>Number of Newton Iterations</em> card is required, there is no default.</p>
<p>See the <em>Jacobian Reform Time Stride</em> card for some detailed examples of the interaction
amongst various input parameters that influence when a Jacobian reformation occurs.</p>
</section>
<section id="id80">
<h3>Examples<a class="headerlink" href="#id80" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">Newton</span> <span class="n">Iterations</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</section>
<section id="id81">
<h3>Technical Discussion<a class="headerlink" href="#id81" title="Permalink to this headline"></a></h3>
<p>For an unrelaxed Newton iteration with a good initial guess, five or six iterations (for
n<sub>1</sub>) should be sufficient to achieve convergence for most problems. One iteration
will
suffice for problems that are linear; two can be specified, with the second iteration
verifying that the residual norms are small. More iterations may be required for relaxed
Newton iteration schemes using the correction factor described in the <em>Newton
correction factor</em> card. This parameter can also be controlled from the command line
(see the <strong>-n</strong> option in the section on Command-line Arguments, Chapter 3).</p>
<p>The optional second parameter can be used to invoke a modified Newton iteration. If
this value is missing, the stride is set to unity. This capability enables the user to save
on assembly time when near a solution, particularly when doing transient simulations.</p>
</section>
</section>
<hr class="docutils" />
<section id="modified-newton-tolerance">
<h2>Modified Newton Tolerance<a class="headerlink" href="#modified-newton-tolerance" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Modified</span> <span class="n">Newton</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">float1</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">float2</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id82">
<h3>Description / Usage<a class="headerlink" href="#id82" title="Permalink to this headline"></a></h3>
<p>This optional card allows the user to exert finer control over Jacobian formation than a
stride specification (as with the <em>Number of Newton Iterations</em> card’s second parameter
or the <em>Jacobian Reform Time Stride</em> card). Input parameters are defined as:</p>
<dl class="simple">
<dt>&lt;float1&gt;</dt><dd><p><strong>r,</strong> if the convergence rate is below this level ( r &gt; 0.0 ), a Jacobian
reformation will be forced.</p>
</dd>
<dt>&lt;float2&gt;</dt><dd><p><strong>t,</strong> if the residual norm is above this level ( t ≥ 0.0 ), a Jacobian
reformation will be forced.</p>
</dd>
</dl>
<p>If the <em>Modified Newton Tolerance</em> card is omitted, then reformations are always
computed, subject to the <em>Number of Newton Iterations’</em> second parameter and the
<em>Jacobian Reform Time Stride</em> value.</p>
<p>See the <em>Jacobian Reform Time Stride</em> card for some detailed examples of the interaction
amongst various cards that influence when a Jacobian reformation occurs.</p>
</section>
<section id="id83">
<h3>Examples<a class="headerlink" href="#id83" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Modified</span> <span class="n">Newton</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="mf">1.0e-8</span>
</pre></div>
</div>
</section>
<section id="id84">
<h3>Technical Discussion<a class="headerlink" href="#id84" title="Permalink to this headline"></a></h3>
<p>The convergence rate is defined as:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\mathrm{convergence} \, \mathrm{rate} = \frac{\log \left( \mathrm{current} L_1 \mathrm{norm} \right) }{\log \left( \mathrm{previous} L_1 \mathrm{norm} \right)}\]</div>
</div></blockquote>
<p>This rate should be equal to 2 when Newton’s method is in its region of convergence
(this is what it means to converge quadratically). A secant method would have a
convergence rate of <span class="math notranslate nohighlight">\(1 + \sqrt{5}/2\)</span> (the golden ratio!), approximately 1.6.</p>
<p>The residual norm is simply the L<sub>1</sub> norm of the residual after a Newton iteration.</p>
<p>The method used to determine if a Jacobian reformation should take place is
conservative. If either test condition for reformation is satisfied, a reformation occurs.
Often, this card will allow you to speed up your runs by foregoing a fresh Jacobian reformation, but still maintain strong convergence. Moreover, without a Jacobian
reformation, the <strong>lu</strong> solver (see the <em>Solution Algorithm</em> card) can use a previously
factored matrix and simply do a resolve.</p>
</section>
</section>
<hr class="docutils" />
<section id="jacobian-reform-time-stride">
<h2>Jacobian Reform Time Stride<a class="headerlink" href="#jacobian-reform-time-stride" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Jacobian</span> <span class="n">Reform</span> <span class="n">Time</span> <span class="n">Stride</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id85">
<h3>Description / Usage<a class="headerlink" href="#id85" title="Permalink to this headline"></a></h3>
<p>This optional card has a single input parameter:</p>
<dl class="simple">
<dt>&lt;integer&gt;</dt><dd><p><strong>k,</strong> the stride length for Jacobian reformations ( <span class="math notranslate nohighlight">\(k \geq 1\)</span> ).</p>
</dd>
</dl>
<p>The <em>Jacobian Reform Time Stride</em> card is optional; there is no default.</p>
</section>
<section id="id86">
<h3>Examples<a class="headerlink" href="#id86" title="Permalink to this headline"></a></h3>
<p>Three examples are provided to illustrate how to use this card.</p>
<p>Example #1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">Newton</span> <span class="n">Iterations</span> <span class="o">=</span> <span class="mi">12</span> <span class="mi">1</span>

<span class="n">Modified</span> <span class="n">Newton</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">1.9</span> <span class="mf">0.1</span>

<span class="n">Jacobian</span> <span class="n">Reform</span> <span class="n">Time</span> <span class="n">Stride</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">Newton</span> <span class="n">correction</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This will reform the Jacobian every 2 steps. Furthermore, if the convergence rate falls
below 1.9 or the L<sub>1</sub> residual is greater than 0.1 on an off-stride step a Jacobian reformation
will occur. Specifically, the*Modified Newton Tolerance* takes precedence over a
reformation stride setting (from either <em>Number of Newton Iterations or Jacobian
Reform Time Stride</em>).</p>
<p>Example #2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">Newton</span> <span class="n">Iterations</span> <span class="o">=</span> <span class="mi">12</span> <span class="mi">1</span>

<span class="c1"># Modified Newton Tolerance = 1.9 0.1</span>

<span class="n">Jacobian</span> <span class="n">Reform</span> <span class="n">Time</span> <span class="n">Stride</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">Newton</span> <span class="n">correction</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Note this differs from the previous example only by omitting the <em>Modified Newton
Tolerance</em> card. This causes the Jacobian to be reformed every other time step.</p>
<p>Example #3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">Newton</span> <span class="n">Iterations</span> <span class="o">=</span> <span class="mi">12</span> <span class="mi">2</span>

<span class="c1"># Modified Newton Tolerance = 1.9 0.1</span>

<span class="n">Jacobian</span> <span class="n">Reform</span> <span class="n">Time</span> <span class="n">Stride</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">Newton</span> <span class="n">correction</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>We’ve changed the <em>Jacobian Reform Time Stride</em> from 2 to 1 and changed the second
parameter of the <em>Number of Newton Iterations</em> card from 1 to 2. This will cause the
Jacobian to be reformed every other step.</p>
</section>
<section id="id87">
<h3>Technical Discussion<a class="headerlink" href="#id87" title="Permalink to this headline"></a></h3>
<p>If the second parameter on the <em>Number of Newton Iterations</em> card is present and greater
than 1, this <em>Jacobian Reform Time Stride</em> card is ignored. Otherwise, this card simply
forces the Jacobian to be rebuilt every <strong>k</strong> Newton steps. Often, this card will allow you
to speed up your runs by foregoing a fresh Jacobian formation, but still maintain strong
convergence. Moreover, without a Jacobian formation, the <strong>lu</strong> solver (see the <em>Solution
Algorithm</em> card) can use a previously factored matrix and simply do a resolve.</p>
</section>
</section>
<hr class="docutils" />
<section id="newton-correction-factor">
<h2>Newton Correction Factor<a class="headerlink" href="#newton-correction-factor" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Newton</span> <span class="n">correction</span> <span class="n">factor</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">float_list</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id88">
<h3>Description / Usage<a class="headerlink" href="#id88" title="Permalink to this headline"></a></h3>
<p>This required card indicates the damping (or relaxation) factor for the Newton updates
and offers customization of the relaxation choice based on the size of the nonlinear
residual from the Newton iteration. Definitions of the &lt;float_list&gt; input parameters,
from one (f<sub>1</sub>) to six (f<sub>2</sub>, … f<sub>6</sub>) floating point numbers (one required and five optional),
are as follows:</p>
<dl class="simple">
<dt>&lt;float1&gt;</dt><dd><p>f<sub>1</sub>, damping factor for the Newton updates, where ( 0.0 &lt; f<sub>1</sub> ≤ 1.0 ). A value of 1.0 gives the usual Newton’s method,
otherwise, only a portion of the Newton update is applied to the solution.
Values near 0 (e.g., 0.1) may be used effectively to aid convergence for
sensitive problems where the initial guess is not very close to the final
solution for the first several Newton iterations. This parameter can also
be controlled from the command line (see <strong>-r</strong> option, Command-line
Arguments, Chapter 3).</p>
</dd>
<dt>[floatn]</dt><dd><p>These five floats [f<sub>2</sub>, … f<sub>6</sub>] are optional but give
a way to more finely control the amount of relaxation applied to Newton
updates. See the description below and the example for an explanation.</p>
</dd>
</dl>
</section>
<section id="id89">
<h3>Examples<a class="headerlink" href="#id89" title="Permalink to this headline"></a></h3>
<p>A simple example is the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Newton</span> <span class="n">correction</span> <span class="n">factor</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
<p>This tells <em>Goma</em> to take the specified number of Newton iterations (from the <em>Number of
Newton Iterations</em> card) at a fixed relaxation parameter of 0.1. This is a moderately
large amount of relaxation, but of course “moderately large” is always problem
dependent.</p>
<p>A more interesting example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Newton</span> <span class="n">correction</span> <span class="n">factor</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="mf">1.0e-6</span> <span class="mf">0.4</span> <span class="mf">1.0e-4</span> <span class="mf">0.1</span> <span class="mf">1.0e-3</span>
</pre></div>
</div>
<p>causes the following relaxation scheme to be used according to the L<sub>∞</sub> norm of the
nonlinear residual:</p>
<ul class="simple">
<li><p>If L<sub>∞</sub> &gt; 1.0e – 3, the relaxation factor is taken as 0.1.</p></li>
<li><p>If 1.0e – 4 &lt; L<sub>∞</sub> ≤ 1.0e – 3, the relaxation factor is taken as 0.4.</p></li>
<li><p>If 1.0e – 6 &lt; L<sub>∞</sub> ≤ 1.0e – 4, the relaxation factor is taken as 0.8.</p></li>
<li><p>If L<sub>∞</sub> ≤ 1.0e – 6, the relaxation factor is taken as the usual Newton’s method
relaxation of 1.0.</p></li>
</ul>
<p>The default relaxation level for small residuals is 1.0.</p>
</section>
<section id="id90">
<h3>Technical Discussion<a class="headerlink" href="#id90" title="Permalink to this headline"></a></h3>
<p>The relaxation factor is used to intentionally shorten the solution update vector
computed by the Newton iteration. There are many factors that can cause the effective
radius of convergence of Newton’s method to be quite small or malformed:</p>
<ul class="simple">
<li><p>the underlying nonlinear problem is stiff,</p></li>
<li><p>the initial solution is poor,</p></li>
<li><p>non-analytic constitutive models or boundary conditions,</p></li>
<li><p>poor linear solver performance, etc.</p></li>
</ul>
<p>Under these kinds of circumstances, the update computed by Newton’s method may be
too large and end up not improving the overall solution. In such cases it is
recommended that one uses some relaxation (e.g., 0.9), and possibly a lot (e.g., 0.05).</p>
<p>What one really wishes to do is to use shortened updates when far from convergence,
and full updates as the solution converges. This is the capability that the optional five
parameters makes available. While they don’t directly measure how far the solution is
from convergence, it does use the residual as an indicator. The full set of six parameters
allows the user to specify four different residual intervals with four different relaxation
factors. The f<sub>1</sub>, f<sub>3</sub> and f<sub>5</sub> values are relaxation factors and must lie in 0.0 &lt; f<sub>i</sub> ≤ 1.0,
while the f<sub>2</sub>, f<sub>4</sub>, and f<sub>6</sub> values are interval endpoints. The supplied interval endpoints
must be in ascending order, 0 &lt; f<sub>2</sub> &lt; f<sub>4</sub> &lt; f<sub>6</sub>. Although no such restriction is put on the
relaxation factors, they should generally satisfy 0 &lt; f<sub>5</sub> ≤ f<sub>3</sub> ≤ f<sub>1</sub> ≤ 1.0.</p>
</section>
</section>
<hr class="docutils" />
<section id="normalized-residual-tolerance">
<h2>Normalized Residual Tolerance<a class="headerlink" href="#normalized-residual-tolerance" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Normalized</span> <span class="n">Residual</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id91">
<h3>Description / Usage<a class="headerlink" href="#id91" title="Permalink to this headline"></a></h3>
<p>This required card indicates the value of the L<sub>2</sub> norm of the global nonlinear residual
vector that indicates termination of Newton’s method (i.e., convergence). The input
parameter is defined as</p>
<dl class="simple">
<dt>&lt;float&gt;</dt><dd><p><strong>tol,</strong> a non-negative floating point number ( tol ≥ 0.0 ) specifying the
L<sub>2</sub> convergence tolerance for the global nonlinear residual vector.</p>
</dd>
</dl>
<p>The <em>Normalized Residual Tolerance</em> card is required; there is no default.</p>
</section>
<section id="id92">
<h3>Examples<a class="headerlink" href="#id92" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Normalized</span> <span class="n">Residual</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">1.0e-11</span>
</pre></div>
</div>
</section>
<section id="id93">
<h3>Technical Discussion<a class="headerlink" href="#id93" title="Permalink to this headline"></a></h3>
<p>Newton’s method is terminated when the global nonlinear residual falls below tol, or
the maximum number of iterations specified in the <em>Number of Newton Iterations</em> is
reached.</p>
</section>
</section>
<hr class="docutils" />
<section id="normalized-correction-tolerance">
<h2>Normalized Correction Tolerance<a class="headerlink" href="#normalized-correction-tolerance" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Normalized</span> <span class="n">Correction</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id94">
<h3>Description / Usage<a class="headerlink" href="#id94" title="Permalink to this headline"></a></h3>
<p>This optional card sets the tolerance for a mixed measure of the size of the update
vector which must be satisfied for the solution to be considered converged. The input
parameter is defined as</p>
<dl class="simple">
<dt>&lt;float&gt;</dt><dd><p><strong>rel,</strong> a floating point value ( rel ≥ 0.0 ) used as the convergence
tolerance for the mixed measure of the update vector (defined in the
Technical Discussion).</p>
</dd>
</dl>
<p>When the <em>Normalized Correction Tolerance</em> card is omitted, the default value of <strong>rel</strong> is
1.0e+10.</p>
</section>
<section id="id95">
<h3>Examples<a class="headerlink" href="#id95" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Normalized</span> <span class="n">Correction</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">1.0e-4</span>
</pre></div>
</div>
</section>
<section id="id96">
<h3>Technical Discussion<a class="headerlink" href="#id96" title="Permalink to this headline"></a></h3>
<p>The mixed measure used here is:</p>
<div class="math notranslate nohighlight">
\[\sqrt{ \sum \frac{ {\Delta x_i}^2}{1 + {x_i}^2} }\]</div>
<p>This measures the relative size of the update vector when the solution vector is large
(i.e., size of unknowns is greater than 1), and measures the absolute size of the update
vector when the solution vector is small (i.e., size of unknowns is much less than 1).</p>
<p>This mixed measure must be less than <strong>rel,</strong> in addition to the nonlinear residual
satisfying the absolute residual tolerance specified in the <em>Normalized Residual
Tolerance</em> card for a solution to be considered converged.</p>
<p>If rel &lt; 1.0 (larger values are not really imposing any restrictions), mixed measure
values are output instead of the update vector norms.</p>
</section>
</section>
<hr class="docutils" />
<section id="residual-ratio-tolerance">
<h2>Residual Ratio Tolerance<a class="headerlink" href="#residual-ratio-tolerance" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Residual</span> <span class="n">Ratio</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id97">
<h3>Description / Usage<a class="headerlink" href="#id97" title="Permalink to this headline"></a></h3>
<p>This optional card sets the convergence criterion for the iterative solution of the linear
matrix system solved at each Newton iteration. The input parameter is defined as</p>
<dl class="simple">
<dt>&lt;float&gt;</dt><dd><p><strong>tol,</strong> a non-negative real number ( tol ≥ 0.0 ) specifying the value of
the convergence criterion.</p>
</dd>
</dl>
<p>The default value of <strong>tol</strong> is 1.0e-6.</p>
</section>
<section id="id98">
<h3>Examples<a class="headerlink" href="#id98" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Residual</span> <span class="n">Ratio</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">1.0e-3</span>
</pre></div>
</div>
</section>
<section id="id99">
<h3>Technical Discussion<a class="headerlink" href="#id99" title="Permalink to this headline"></a></h3>
<p>The value of <strong>tol</strong> is ignored when a direct factorization algorithm (such as <strong>lu</strong>) for
the
linear solve is specified in the <em>Solution Algorithm</em> card. When an iterative matrix
solution technique is specified (such as <strong>gmres</strong>), <strong>tol</strong> acts as the inner iteration
termination relative tolerance. Letting r<sub>0</sub> represent the initial residual norm,
when the
n<sub>th</sub> iteration’s linear residual norm r<sub>n</sub> satisfies
r<sub>n</sub> / r:sub :<cite>0</cite> ≤ tol, the iterative
solution is
deemed acceptable and the inner iterations terminate. The number of iterations required
is reported under the LIS column of the Newton iteration output. If the maximum
number of iterations (specified in the <em>Maximum Linear Solve Iterations</em> card) is
reached, then <strong>max</strong> appears instead of a number. Although the standard residual is
usually used as the residual norm, the type of matrix residual norm used can be
changed through the <em>Matrix residual norm type</em> card.</p>
</section>
</section>
<hr class="docutils" />
<section id="pressure-stabilization">
<h2>Pressure Stabilization<a class="headerlink" href="#pressure-stabilization" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pressure</span> <span class="n">Stabilization</span> <span class="o">=</span> <span class="p">{</span><span class="n">yes</span> <span class="o">|</span> <span class="n">no</span> <span class="o">|</span> <span class="n">local</span> <span class="o">|</span> <span class="n">pspp</span> <span class="o">|</span> <span class="n">pspp_e</span><span class="p">}</span>
</pre></div>
</div>
<section id="id100">
<h3>Description / Usage<a class="headerlink" href="#id100" title="Permalink to this headline"></a></h3>
<p>This optional card indicates whether or not pressure stabilization should be used. Valid
options are</p>
<dl class="simple">
<dt>yes</dt><dd><p>Use the Galerkin Least square pressure stabilization method developed by
Hughes, et. al. (1986).</p>
</dd>
<dt>local</dt><dd><p>Use the Galerkin Least square pressure stabilization method with local
scaling.</p>
</dd>
<dt>pspp</dt><dd><p>Use polynomial stabilized pressure projection stabilization method
developed by Dohrmann and Bochev (2004). Please see Level Set PSPP
filtering card if using with the level-set front tracking technique.</p>
</dd>
<dt>pspp_e</dt><dd><p>Use polynomial stabilized pressure projection method with upgrade for
nonuniform/graded meshes (recommended)</p>
</dd>
<dt>no</dt><dd><p>Do not use any pressure stabilization.</p>
</dd>
</dl>
<p>The amount of pressure stabilization to use is specified with the <em>Pressure Stabilization
Scaling</em> card.</p>
<p>The default is <strong>no</strong>, to not use pressure stabilization.</p>
</section>
<section id="id101">
<h3>Examples<a class="headerlink" href="#id101" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pressure</span> <span class="n">Stabilization</span> <span class="o">=</span> <span class="n">yes</span>
</pre></div>
</div>
</section>
<section id="id102">
<h3>Technical Discussion<a class="headerlink" href="#id102" title="Permalink to this headline"></a></h3>
<p>If input for this card is <strong>yes</strong>, the Hughes, et al. (1986) method adds the residual of the
momentum equation weighted by the gradient of the Galerkin weight function to the
Galerkin continuity equation. The result is that the continuity equation now has a
diagonal term to stabilize it and improve the condition of the matrix, allowing for the
use of iterative solvers. When pressure stabilization is used, equal-order interpolation
can (and should) be used for velocity and pressure, e.g., velocity and pressure both Q2
or both Q1. If input for this card is <strong>no</strong>, then the standard Galerkin finite-element weight
functions are used and velocity and pressure interpolations should be chosen to satisfy
the Babuska-Brezzi condition, e.g., velocity Q2 and pressure Q1 or P1, or velocity Q1
and pressure P0.</p>
<p>An improvement on the Hughes approach was developed by Bochev and Dohrmann
(2004) called the polynomial stabilized pressure projection. In its fundamental form, it
is like PSPG just an additional term on the continuity equation residual that helps
stabilize the pressure, and it is predicated on the fact that the pressure field is governed
by an elliptical equation known as the pressure Poisson equation. Please consult this
paper for details. An additional improvement to that technique was developed
internally to Sandia which better accommodates graded meshes. This technique is
invoked with the pspp_e option, which we recommend.</p>
</section>
<section id="id103">
<h3>References<a class="headerlink" href="#id103" title="Permalink to this headline"></a></h3>
<p>Hughes, T. J. R., L. P. Franca and M. Balestra, “A New Finite Element Formulation for
Computational Fluid Dynamics: V. Circumventing the Babuska-Brezzi Condition: A
Stable Petrov-Galerkin Formulation of the Stokes Problem Accommodating Equal-
Order Interpolations,” <em>Comput. Methods Appl. Mech. Engrg.</em>, 59 (1986) 85-99.</p>
</section>
</section>
<hr class="docutils" />
<section id="pressure-stabilization-scaling">
<h2>Pressure Stabilization Scaling<a class="headerlink" href="#pressure-stabilization-scaling" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pressure</span> <span class="n">Stabilization</span> <span class="n">Scaling</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id104">
<h3>Description / Usage<a class="headerlink" href="#id104" title="Permalink to this headline"></a></h3>
<p>This optional card is only used if the Pressure Stabilization card is set to <strong>yes,</strong> where</p>
<dl class="simple">
<dt>&lt;float&gt;</dt><dd><p><strong>tau,</strong> a positive real value ( tau &gt; 0.0 ) that scales the momentum
residual being added to the continuity equation for pressure stabilization.</p>
</dd>
</dl>
<p>The default value of <strong>tau</strong> is 0.1. If the <em>Pressure Stabilization</em> card is omitted, or set to
<strong>no,</strong> then <strong>tau</strong> is ignored.</p>
</section>
<section id="id105">
<h3>Examples<a class="headerlink" href="#id105" title="Permalink to this headline"></a></h3>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pressure</span> <span class="n">Stabilization</span> <span class="n">Scaling</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>
</div>
</section>
<section id="id106">
<h3>Technical Discussion<a class="headerlink" href="#id106" title="Permalink to this headline"></a></h3>
<p>Generally, if <strong>tau</strong> is small, then more accurate solutions may be obtained at the cost of a
more ill-conditioned matrix system that may not be easily amenable to iterative solvers
(but stay tuned!). Conversely, larger values of this parameter result in equation systems
that are easier to solve using the available iterative matrix solvers, but the solution thus
obtained may be less accurate. A good choice for <strong>tau</strong> is 0.1.</p>
<p>The scaling value, <strong>tau,</strong> is further scaled inside of <em>Goma</em>. Knowledge of this scaling is
sometimes useful. First, an average Reynolds number (<em>Re</em>) is computed according to:</p>
<div class="math notranslate nohighlight">
\[\mathrm{Re} = \frac{\rho \lVert U \rVert \langle h \rangle }{2 \mu}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span> are local values for density and viscosity, <span class="math notranslate nohighlight">\(\lVert U \rVert\)</span> is a norm of the velocity
field, and <span class="math notranslate nohighlight">\(\langle h \rangle\)</span> is a global average value for element size. If Re &lt; 3.0, the pressure
stabilization scaling is given by this expression:</p>
<div class="math notranslate nohighlight">
\[\frac{ \mathrm{tau} {\langle h \rangle}^2 }{12 \mu}\]</div>
<p>On the other hand, if Re &gt; 3.0, the following scales the pressure stabilization terms in
the continuity equation:</p>
<div class="math notranslate nohighlight">
\[\frac{ \mathrm{tau} {\langle h \rangle} }{2 \rho \lVert U \rVert}\]</div>
</section>
</section>
<hr class="docutils" />
<section id="linear-stability">
<h2>Linear Stability<a class="headerlink" href="#linear-stability" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Linear</span> <span class="n">Stability</span> <span class="o">=</span> <span class="p">{</span><span class="n">char_list</span><span class="p">}</span>
</pre></div>
</div>
<section id="id107">
<h3>Description / Usage<a class="headerlink" href="#id107" title="Permalink to this headline"></a></h3>
<p>This optional card indicates whether or not linear stability analysis should be
performed, as well as what kind.</p>
<p>The valid options for {char_list} are:</p>
<dl class="simple">
<dt>no</dt><dd><p>Do not perform any kind of linear stability analysis.</p>
</dd>
<dt>yes</dt><dd><p>Perform regular linear stability analysis. If your problem was 2D, then 2D
analysis is performed. If your problem was 3D, then 3D analysis is
performed.</p>
</dd>
<dt>inline</dt><dd><p>Same as yes, perform regular linear stability analysis.</p>
</dd>
<dt>3D</dt><dd><p>Subject the 2D flow to 3D linear stability analysis by normal mode
expansion for the modes specified with the <em>Eigen Wave Numbers</em> card.</p>
</dd>
<dt>file</dt><dd><p>Set up the problem as in <strong>yes</strong> or <strong>inline,</strong> but output the matrices
involved instead of determining stability.</p>
</dd>
<dt>3Dfile</dt><dd><p>Set up the problem as in <strong>3D,</strong> but output the matrices involved instead
of determining stability.</p>
</dd>
</dl>
<p>The default value is <strong>no.</strong></p>
</section>
<section id="id108">
<h3>Examples<a class="headerlink" href="#id108" title="Permalink to this headline"></a></h3>
<p>Here is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Linear</span> <span class="n">Stability</span> <span class="o">=</span> <span class="n">yes</span>
</pre></div>
</div>
</section>
<section id="id109">
<h3>Technical Discussion<a class="headerlink" href="#id109" title="Permalink to this headline"></a></h3>
<p>When linear stability analysis is performed, a steady-state solution is first acquired, and
then the eigenvalue/eigenvector spectrum is computed subject to the choices made in
the <em>Eigensolver Specifications</em> section. In the case of <strong>file</strong> or <strong>3Dfile,</strong> the steady-state
solution is acquired and then the matrices that would have been used to compute the
spectrum are exported to file and no spectrum is actually computed. Refer to the
Advanced Capabilities (Gates, et. al., 2001) document for a more thorough description.</p>
<p>The name of the output files when <strong>file</strong> is specified are:</p>
<ul class="simple">
<li><p>LSA_mass_coo.out         for the mass matrix, B or M,</p></li>
<li><p>LSA_jac_coo.out          for the jacobian matrix, J,</p></li>
<li><p>LSA_vars.out             for variable names associated with unknowns.</p></li>
</ul>
<p>When <strong>3Dfile</strong> is specified, the names are:</p>
<ul class="simple">
<li><p>LSA_mass_coo-&lt;f&gt;.out,    for the mass matrix, B or M,</p></li>
<li><p>LSA_jac_coo-&lt;f&gt;.out,     for the jacobian matrix, J,</p></li>
<li><p>LSA_vars.out,            for variable names associated with unknowns.</p></li>
</ul>
<p>where &lt;f&gt; is the value of the requested normal mode (see the <em>Eigen Wave Numbers</em>
card). The <em>Eigen Matrix Output</em> card must be set to <strong>yes</strong> in order to create and write
these files.</p>
<p>When computing the 3D stability of a base 2D flow, other modifications need to be
made (see the 3D stability of 2D flow memo).</p>
<p>See the Advanced Capabilities document (Gates, et. al., 2001), or it’s replacement
(Labreche, et. al., 2002).</p>
</section>
<section id="id110">
<h3>References<a class="headerlink" href="#id110" title="Permalink to this headline"></a></h3>
<p>SAND2000-2465: Advanced Capabilities in Goma 3.0 - Augmenting Conditions,
Automatic Continuation, and Linear Stability Analysis, I. D. Gates, D. A. Labreche and
M. M. Hopkins (January 2001)</p>
<p>SAND2002-xxxx: Advanced Capabilities in Goma 4.0 - Augmenting Conditions,
Automatic Continuation, and Linear Stability Analysis, Labreche, D. A., Wilkes, E. D.,
Hopkins, M. M. and Sun, A. C., (in preparation)</p>
</section>
</section>
<hr class="docutils" />
<section id="filter-concentration">
<h2>Filter Concentration<a class="headerlink" href="#filter-concentration" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Filter</span> <span class="n">Concentration</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">float1</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">float2</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="id111">
<h3>Description / Usage<a class="headerlink" href="#id111" title="Permalink to this headline"></a></h3>
<p>This optional card allows the user to enforce strict bounds on the concentration of a
specific species. The input parameters are defined as:</p>
<dl class="simple">
<dt>&lt;integer&gt;</dt><dd><p><strong>i,</strong> this integer indicates which species ( i ≥ 0 ) receives this special
restriction.</p>
</dd>
<dt>&lt;float1&gt;</dt><dd><p><strong>min,</strong> a real number indicating the minimum concentration.</p>
</dd>
<dt>&lt;float2&gt;</dt><dd><p><strong>max,</strong> a real number indicating the maximum concentration.</p>
</dd>
</dl>
<p>There are no default values; concentrations take on whatever values are naturally
dictated by the Newton iterations.</p>
</section>
<section id="id112">
<h3>Examples<a class="headerlink" href="#id112" title="Permalink to this headline"></a></h3>
<p>The following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Filter</span> <span class="n">Concentration</span> <span class="o">=</span> <span class="mi">0</span> <span class="mf">0.0</span> <span class="mf">1.0</span>
</pre></div>
</div>
</section>
<section id="id113">
<h3>Technical Discussion<a class="headerlink" href="#id113" title="Permalink to this headline"></a></h3>
<p>Although a correct solution should not have concentrations less than 0 or greater than
1.0, such values may arise in the solution vector due to various sources. Intermediate
solutions during the Newton iteration may cause non-physical values to arise.
Numerical error due to inexact linear solves, rounding, etc., may cause the values to be
inexact. This card allows the user to force the concentration of species <strong>i</strong> to be corrected
to fall within a strict concentration range <strong>[min,max]</strong> after the Newton iterations have
terminated.</p>
</section>
</section>
<hr class="docutils" />
<section id="disable-viscosity-sensitivities">
<h2>Disable Viscosity Sensitivities<a class="headerlink" href="#disable-viscosity-sensitivities" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Disable</span> <span class="n">Viscosity</span> <span class="n">Sensitivities</span> <span class="o">=</span> <span class="p">{</span><span class="n">yes</span> <span class="o">|</span> <span class="n">no</span><span class="p">}</span>
</pre></div>
</div>
<section id="id114">
<h3>Description / Usage<a class="headerlink" href="#id114" title="Permalink to this headline"></a></h3>
<p>This optional card permits the analyst to omit the sensitivities of a shear-thinning
viscosity model with respect to shear rate from the Jacobian.Valid options for this card
are</p>
<dl class="simple">
<dt>yes</dt><dd><p>Omit the sensitivities of a shear-thinning viscosity model with respect to
shear rate from the Jacobian</p>
</dd>
<dt>no</dt><dd><p>Form the complete Jacobian.</p>
</dd>
</dl>
<p>Currently, this card will have an effect only when using the following viscosity models:
<strong>POWER_LAW, CARREAU, BINGHAM</strong> (see the <em>Liquid Constitutive Equation</em>
card).</p>
<p>The default value is <strong>no</strong>.</p>
</section>
<section id="id115">
<h3>Examples<a class="headerlink" href="#id115" title="Permalink to this headline"></a></h3>
<p>The following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Disable</span> <span class="n">Viscosity</span> <span class="n">Sensitivities</span> <span class="o">=</span> <span class="n">yes</span>
</pre></div>
</div>
</section>
<section id="id116">
<h3>Technical Discussion<a class="headerlink" href="#id116" title="Permalink to this headline"></a></h3>
<p>It has been observed that when these terms are included for very highly
shear-thinning models the result can be non-convergence. In such situations,
disabling these terms can often result in a convergent answer but at
a convergence rate far less than the usual quadratic.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="augmenting_conditions.html" class="btn btn-neutral float-left" title="Augmenting Conditions Specifications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="eigensolver.html" class="btn btn-neutral float-right" title="Eigensolver Specifications" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019 Goma Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>