<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Debug &mdash; Goma User Manual 6.1.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Goma User Manual
            <img src="../../_static/goma.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                6.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../background.html">Background Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code_structure_and_io.html">Code Structure and I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../problem_description_file.html">Problem Description (Input File)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../material_files.html">Material Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../documentation_lists.html">Appendix 1: Goma Documentation Lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../library_mode.html">Appendix 2: Using Goma in Library Mode</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Goma User Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><strong>Debug</strong></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/problem_description_file/general_specifications/debug.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="debug">
<h1><strong>Debug</strong><a class="headerlink" href="#debug" title="Permalink to this headline"></a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Debug</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">integer</span><span class="o">&gt;</span>
</pre></div>
</div>
<section id="description-usage">
<h2><strong>Description / Usage</strong><a class="headerlink" href="#description-usage" title="Permalink to this headline"></a></h2>
<p>This optional card specifies the level of information output to files stdout and
stderr. The permissible values for &lt;integer&gt; are <strong>-3</strong> through <strong>4</strong>, depending on the level
of informational (debugging) output desired; higher values of the output level will
produce more diagnostic information output on the stdout and stderr output
channels. The default level is 0. Specific results produced for each level are
summarized below. The user should exercise caution in using values other than the
default for problems with large numbers of unknowns as the volume of information
increases very quickly.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Level</p></th>
<th class="head"><p>Results Output</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>No output (default).</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Logs activity as the code does problem setup, including setting
addresses and sizes, boundary-condition (BC) conflictresolution
information, and identification of the rotation
conditions at every node with a boundary flag. Prints out surface
boundary integral setup information. Lists matrix and solver
information for each solution step.</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Prints same information as level 1, plus provides a summary of
BC type information for each BC and logs the beginning and
end of matrix fill operations.</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Prints same information as level 2, but also prints a list of
variables/unknowns at each node.</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Prints same information as for level 3.</p></td>
</tr>
<tr class="row-odd"><td><p>-1</p></td>
<td><p>Logs activity as the code does problem setup and prints out
surface boundary integral setup information as is done for mode
1. Triggers a comparison of the analytical Jacobian and the
numerical Jacobian in un-scaled form, which can be used to
check the compatibility of the analytical residual equations and
Jacobian. Prints results only if the analytical and numerical
Jacobian are different. Does not solve any equations; terminates
after Jacobian print out.</p></td>
</tr>
<tr class="row-even"><td><p>-2</p></td>
<td><p>Same initial information as for level -1. Triggers a comparison
of the analytical Jacobian and the numerical Jacobian scaled by
the sum of each row of the analytical Jacobian (this helps
suppress small errors in large Jacobian entries). Prints results
only if the analytical and numerical Jacobian are different.</p></td>
</tr>
<tr class="row-odd"><td><p>-3</p></td>
<td><p>Similar to level -2 except each row is scaled by the diagonal
value which is usually the largest. Prints results only if the
analytical and numerical Jacobian are different.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="examples">
<h2><strong>Examples</strong><a class="headerlink" href="#examples" title="Permalink to this headline"></a></h2>
<p>Following is a sample card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Debug</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
</pre></div>
</div>
</section>
<section id="technical-discussion">
<h2><strong>Technical Discussion</strong><a class="headerlink" href="#technical-discussion" title="Permalink to this headline"></a></h2>
<p>For options -1, -2, -3, viz. numerical Jacobian checking, the user must take care when
interpreting the cited differences in the numerical and analytical Jacobian. The comparison is made by perturbing each variable and comparing the numerical Jacobian
computed between the perturbed and unperturbed states to the analytical Jacobians at
the two states. A difference is deemed significant if the numerical Jacobian falls outside
the band between the two analytical values with an additional allowance for roundoff
error. It is the roundoff error in the residual that is the most difficult for the Jacobian
checker to estimate. This is particularly true for problems with zero initial conditions
since it is impossible to determine the scale of a velocity, for example, if all the values
of velocity are zero. For this reason, it is often better to use a nonzero initial condition
or a scaled problem (with values order unity) when using the Jacobian checker.</p>
<p>Currently, there are two parameters output by the Jacobian checker that can help the
user decide on the significance of the entry. The first is the relative change in the
analytical residual. This quantity, labeled d<sub>aj</sub>, is the percentage of the acceptance band
that comes from changes in the analytical Jacobian from the unperturbed to perturbed
states. For a non-linear dependency, the difference between the analytical Jacobians
will be significant and it is reasonable to expect that the numerical Jacobian should fall
within the band. If the analytical Jacobian is nearly constant over the perturbation, the
accuracy of the check becomes increasingly dependent on knowing the roundoff error
in the residual. So, as d<sub>aj</sub> gets closer to unity, the user can have more confidence that
the entry is significant.</p>
<p>The second parameter is a confidence measure that is the deviation between the
numerical jacobian and analytical values divided by the expected value of the deviation
based on roundoff error. Since the roundoff error is only known approximately, this
value, called <em>conf</em>, is only a qualitative measure of the confidence. A <em>conf</em> value of 100
means that the deviation between the numerical jacobian and the analytical values is
100 times larger than the expected deviation based on roundoff error.</p>
<p>Here is a sample of output from a convective heat transfer problem, using the -2 option</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Eqdof</span><span class="o">=</span><span class="mi">92</span> <span class="n">T_0</span> <span class="n">n</span><span class="o">=</span><span class="mi">31</span> <span class="n">Vardof</span><span class="o">=</span><span class="mi">95</span> <span class="n">T_0</span> <span class="n">n</span><span class="o">=</span><span class="mi">32</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span>
<span class="n">dx</span><span class="o">=</span><span class="mf">0.0001</span> <span class="n">aj</span><span class="o">=-</span><span class="mf">0.008188</span> <span class="n">nj</span><span class="o">=-</span><span class="mf">0.008126</span> <span class="n">aj_1</span><span class="o">=-</span><span class="mf">0.008188</span> <span class="n">d_aj</span><span class="o">=</span><span class="mi">0</span>
<span class="n">conf</span><span class="o">=</span><span class="mf">1.889e+06</span>

  <span class="o">&gt;&gt;&gt;</span> <span class="n">QCONV</span> <span class="n">on</span> <span class="n">SSID</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>This entry can be read as follows: The sensitivity of global equation number 92, which
happens to be the T_0 energy equation at node 31, with respect to the temperature
variable at node 32 (variable global degree of freedom number 95) has an analytical
Jacobian of -0.008188 at the unperturbed state and a computed numerical Jacobian of
0.008126. The analytical jacobian at the perturbed state is -0.008188. For this problem
the change in the analytical Jacobian is zero between the unperturbed and perturbed
states, so d<sub>aj</sub> is zero. But even though the difference is small between the analytical and
numerical values, it is huge relative to the expected roundoff error, with the deviation
being 1.889e+6 times the deviation attributable to roundoff error.</p>
<p>For each node where a deviation is found, the side boundary conditions applied at the
node are printed, as shown above. If one of these boundary conditions are applied to the
equation that shows an error and have the same dependency that is showing the error,
this boundary condition is flagged as shown for the QCONV boundary condition
above.</p>
<p>Before the user/developer concludes that there is a discrepancy in the analytical
Jacobian, a few things should be tried:</p>
<ul class="simple">
<li><p>Giving the problem a nonzero initial guess, either by reading in a STEADY state
solution, if one exists, or on transient problems using the “one” option on the
Initial Guess card. Sometimes this will make many differences disappear.</p></li>
<li><p>Checking whether the nodes cited in the difference outputs are boundary nodes.
Specifically, if they are boundary nodes on which Dirichlet boundary conditions
are specified, artificial errors can occur.</p></li>
<li><p>Also, if you are in doubt that there are not reported errors, put one in by a 10
percent perturbation to the residual. The Jacobian checker should hit on those
errors and report them to you.</p></li>
<li><p>Check the settings in <em>mm_numjac.h</em>.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019 Goma Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>